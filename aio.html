<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Real-time analysis and forecasting for outbreak analytics with R: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="assets/styles.css">
<script src="assets/scripts.js" type="text/javascript"></script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-XZ471458FQ');
    </script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="manifest" href="site.webmanifest">
<link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav incubator"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Epiverse-TRACE" src="assets/images/epiverse-logo.svg"><abbr class="badge badge-light" title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught." style="background-color: #FF4955; border-radius: 5px">
          <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link" style="color: #FFF">
            <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
            Pre-Alpha
          </a>
          <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
        </abbr>
        
      </div>
    </div>
    <div class="selector-container">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/aio.html';">Instructor View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Epiverse-TRACE" src="assets/images/epiverse-logo.svg">
</div>
    <div class="lesson-title-md">
      Real-time analysis and forecasting for outbreak analytics with R
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="search button" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Real-time analysis and forecasting for outbreak analytics with R
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<li><a class="dropdown-item" href="reference.html">Glossary of Terms: Epiverse-TRACE</a></li>
          </ul>
</li>
      </ul>
</div>
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
<input class="form-control me-2 searchbox" type="search" placeholder="Search" aria-label="Search"><button class="btn btn-outline-success tablet-search-button" type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="search button"></i>
        </button>
      </fieldset>
</form>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Real-time analysis and forecasting for outbreak analytics with R
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/aio.html">Instructor View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->
      
            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="introduction.html">1. Outbreak analytics pipelines</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="read-delays.html">2. Read delays</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="quantify-transmissibility.html">3. Quantifying transmission</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="create-forecast.html">4. Create a short-term forecast</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="reference.html">Glossary of Terms: Epiverse-TRACE</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width resources">
<a href="aio.html">See all in one page</a>
            

            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">
            
            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-introduction"><p>Content from <a href="introduction.html">Outbreak analytics pipelines</a></p>
<hr>
<p>Last updated on 2024-02-08 |
        
        <a href="https://github.com/epiverse-trace/tutorials/edit/main/episodes/introduction.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Why use R packages for Outbreak analytics?</li>
<li>What can we do to analyse our outbreak data?</li>
<li>How can I start doing Outbreak Analytics with R?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain our vision on the need for outbreak analytics R
packages.</li>
<li>Share our strategy to create R packages into an outbreak analytics
pipeline.</li>
<li>Define our plan to start your learning path in outbreak analytics
with R.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="prerequisites" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div id="prerequisites" class="callout-inner">
<h3 class="callout-title">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h3>
<div class="callout-content">
<p>This episode requires you to be familiar with:</p>
<p><strong>Data science</strong> : Basic programming with R.</p>
<p><strong>Epidemic theory</strong> : Reproduction number.</p>
</div>
</div>
</div>
<section id="why-to-use-r-packages-for-outbreak-analytics"><h2 class="section-heading">Why to use R packages for Outbreak analytics?<a class="anchor" aria-label="anchor" href="#why-to-use-r-packages-for-outbreak-analytics"></a>
</h2>
<hr class="half-width">
<p>Outbreaks appear with different diseases and in different contexts,
but what all of them have in common are the key public health questions
(<a href="https://royalsocietypublishing.org/doi/10.1098/rstb.2016.0371#d1e605" class="external-link">Cori
et al. 2017</a>).</p>
<p>Is the epidemic going to take off? Is it under control? How much
effort will be needed to control it? We can answer them by
<em>quantifying the transmissibility</em> of the disease. The most used
parameter for this is the reproduction number (<span class="math inline">\(R\)</span>), the average number of secondary
infections caused by a typical primary case in the population of
interest (<a href="http://prism.edu.au/publications/prism-modeling-guideline/" class="external-link">Prism,
2016</a>). We can intuitively interpret it as:</p>
<ul>
<li>if <span class="math inline">\(R&gt;1\)</span>, the epidemic is
likely to grow,</li>
<li>if <span class="math inline">\(R&lt;1\)</span>, the epidemic is
likely to decline.</li>
</ul>
<p>We can estimate the reproduction number by initially using two
<strong>data inputs</strong>: the incidence of reported cases and the <a href="reference.html#generationtime">generation time</a> distribution.
But to calculate it, we must apply the appropriate mathematical models
written in code with the required computational methods. That is not
enough! Following <em>good practices</em>, the code we write should be
peer-reviewed and contain internal tests to double-check that we are
getting the estimates we expect. Imagine rewriting all of it during a
health emergency!</p>
<p>In R, the fundamental unit of shareable code is the <em>package</em>.
A package bundles together code, data, documentation, and tests and is
easy to share with others (<a href="https://r-pkgs.org/introduction.html" class="external-link">Wickham and Bryan,
2023</a>). We, as epidemiologists, can contribute to their collaborative
maintenance as a community to perform less error-prone data analysis
pipelines.</p>
<div id="questions-to-think-about" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="questions-to-think-about" class="callout-inner">
<h3 class="callout-title">Questions to think about<a class="anchor" aria-label="anchor" href="#questions-to-think-about"></a>
</h3>
<div class="callout-content">
<p>Remember your last experience with outbreak data and reflect on these
questions:</p>
<ul>
<li>What data sources did you need to understand the outbreak?</li>
<li>How did you get access to that data?</li>
<li>Is that analysis pipeline you followed reusable for the next
response?</li>
</ul>
<p>Reflect on your experiences.</p>
</div>
</div>
</div>
</section><section id="example-quantify-transmission"><h2 class="section-heading">Example: Quantify transmission<a class="anchor" aria-label="anchor" href="#example-quantify-transmission"></a>
</h2>
<hr class="half-width">
<p>The <a href="https://epiforecasts.io/EpiNow2/" class="external-link">EpiNow2</a> package provides a three-step solution to
<em>quantify the transmissibility</em>. Let’s see how to do this with a
minimal example. First, load the package:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">EpiNow2</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="first-get-your-case-data">First, get your case data<a class="anchor" aria-label="anchor" href="#first-get-your-case-data"></a>
</h3>
<p>Case incidence data must be stored in a data frame with the observed
number of cases per day. We can read an example from the package:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_confirmed</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>           date confirm
         &lt;Date&gt;   &lt;num&gt;
  1: 2020-02-22      14
  2: 2020-02-23      62
  3: 2020-02-24      53
  4: 2020-02-25      97
  5: 2020-02-26      93
 ---                   
126: 2020-06-26     296
127: 2020-06-27     255
128: 2020-06-28     175
129: 2020-06-29     174
130: 2020-06-30     126</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="then-set-the-generation-time">Then, set the generation time<a class="anchor" aria-label="anchor" href="#then-set-the-generation-time"></a>
</h3>
<p>Not all primary cases have the same probability of generating a
secondary case. The onset and cessation of <a href="reference.html#infectiousness">infectiousness</a> may occur
gradually. For <a href="https://epiforecasts.io/EpiNow2/" class="external-link">EpiNow2</a>, we can specify it as a
probability <code>distribution</code> with <code>mean</code>, standard
deviation <code>sd</code>, and maximum value <code>max</code>:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">generation_time</span> <span class="op">&lt;-</span> <span class="fu">dist_spec</span><span class="op">(</span></span>
<span>  mean <span class="op">=</span> <span class="fl">3.6</span>,</span>
<span>  sd <span class="op">=</span> <span class="fl">3.1</span>,</span>
<span>  max <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  distribution <span class="op">=</span> <span class="st">"lognormal"</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="lets-calculate-the-reproduction-number">Let’s calculate the reproduction number!<a class="anchor" aria-label="anchor" href="#lets-calculate-the-reproduction-number"></a>
</h3>
<p>In the <code>epinow()</code> function we can add:</p>
<ul>
<li>the <code>reported_cases</code> data frame,</li>
<li>the <code>generation_time</code> delay distribution, and</li>
<li>the computation <code>stan</code> parameters for this
calculation:</li>
</ul>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">epinow_estimates</span> <span class="op">&lt;-</span> <span class="fu">epinow</span><span class="op">(</span></span>
<span>  <span class="co"># cases</span></span>
<span>  reported_cases <span class="op">=</span> <span class="va">example_confirmed</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">60</span><span class="op">]</span>,</span>
<span>  <span class="co"># delays</span></span>
<span>  generation_time <span class="op">=</span> <span class="fu">generation_time_opts</span><span class="op">(</span><span class="va">generation_time</span><span class="op">)</span>,</span>
<span>  <span class="co"># computation</span></span>
<span>  stan <span class="op">=</span> <span class="fu">stan_opts</span><span class="op">(</span></span>
<span>    cores <span class="op">=</span> <span class="fl">4</span>, samples <span class="op">=</span> <span class="fl">1000</span>, chains <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    control <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>WARN [2024-02-08 10:18:42] epinow: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.
Running the chains for more iterations may help. See
https://mc-stan.org/misc/warnings.html#bulk-ess - </code></pre>
</div>
<p>As an output, we get the time-varying (or <a href="reference.html#effectiverepro">effective</a>) reproduction number,
as well as the cases by date of report and date of infection:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">base</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span><span class="va">epinow_estimates</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/introduction-rendered-unnamed-chunk-5-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="is-this-rt-estimation-biased" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="is-this-rt-estimation-biased" class="callout-inner">
<h3 class="callout-title">Is this<span class="math inline">\(Rt\)</span>estimation biased?<a class="anchor" aria-label="anchor" href="#is-this-rt-estimation-biased"></a>
</h3>
<div class="callout-content">
<p>Review <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1008409" class="external-link">Gostic
et al., 2020</a> about what additional adjustments this estimation
requires to avoid false precision in <span class="math inline">\(Rt\)</span>.</p>
</div>
</div>
</div>
</div>
</section><section id="the-problem"><h2 class="section-heading">The problem!<a class="anchor" aria-label="anchor" href="#the-problem"></a>
</h2>
<hr class="half-width">
<p>However, <em>quantifying the transmissibility</em> during a real-life
outbreak response is more challenging than this example!</p>
<p>Usually, we receive outbreak data in non-standard formats, requiring
specific steps and taking the most time to prepare usable data inputs.
Some of them are:</p>
<ul>
<li>Read delay distributions from the literature</li>
<li>Read and clean case data</li>
<li>Validate your line list</li>
<li>Describe case data</li>
</ul>
<p>And this is not the end. After <em>quantifying transmissibility</em>
we need to answer more key public health questions like: What is the
attack rate we expect? What would be the impact of a given intervention?
We can use the reproduction number and other outputs as new inputs for
complementary tasks. For example:</p>
<ul>
<li>Estimate severity</li>
<li>Create short-term forecast</li>
<li>Simulate transmission scenarios</li>
<li>Compare interventions</li>
</ul>
<p>So, all these tasks can be interconnected in a pipeline:</p>
<figure><img src="https://epiverse-trace.github.io/task_pipeline-minimal.svg" alt="" class="figure mx-auto d-block"><figcaption>The outbreak analytics pipeline.</figcaption></figure></section><section id="what-can-we-do"><h2 class="section-heading">What can we do?<a class="anchor" aria-label="anchor" href="#what-can-we-do"></a>
</h2>
<hr class="half-width">
<p>Our strategy is gradually incorporating specialised R packages into
our traditional analysis pipeline. These packages should fill the gaps
in these epidemiology-specific tasks in response to outbreaks.</p>
<p>Epiverse-TRACE’s aim is to provide a software ecosystem for outbreak
analytics. We support the development of software pieces, make the
existing ones interoperable for the user experience, and stimulate a
community of practice.</p>
<figure><img src="fig/pkgs-hexlogos.png" class="figure mx-auto d-block"></figure></section><section id="how-can-i-start"><h2 class="section-heading">How can I start?<a class="anchor" aria-label="anchor" href="#how-can-i-start"></a>
</h2>
<hr class="half-width">
<p>Our plan for these tutorials is to introduce key solutions from
packages in all the tasks before and after the <em>Quantify
transmission</em> task, plus the required theory concepts to interpret
modelling outputs and make rigorous conclusions.</p>
<ul>
<li><p>In the first set of episodes, you will learn how to optimise the
reading of delay distributions and cleaning of case data to input them
into the <em>Quantify transmission</em> task. These preliminary tasks
are the <strong>Early tasks</strong>. These include packages like
<code>{readepi}</code>, <code>{cleanepi}</code>,
<a href="https://epiverse-trace.github.io/linelist/" class="external-link">linelist</a>, <code>{epiparameter}</code>, and
<code>{episoap}</code>.</p></li>
<li><p>Then, we will get deeper into the packages and required theory to
<em>Quantify transmission</em> and perform more real-time analysis tasks
next to it. These are the <strong>Middle tasks</strong>. This includes
<a href="https://epiforecasts.io/EpiNow2/" class="external-link">EpiNow2</a>, <a href="https://github.com/epiverse-trace/cfr" class="external-link">cfr</a>, <code>{epichains}</code>,
and <code>{superspreading}</code>.</p></li>
<li><p>Lastly, we will use <em>Quantify transmission</em> data outputs
to compare it to other indicators and simulate epidemic scenarios as
part of the <strong>Late tasks</strong>. This includes
<a href="https://github.com/epiverse-trace/finalsize" class="external-link">finalsize</a>, <code>{epidemics}</code>, and
<code>{scenarios}</code>.</p></li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Our vision is to have pipelines of R packages for outbreak
analytics.</li>
<li>Our strategy is to create interconnected tasks to get relevant
outputs for public health questions.</li>
<li>We plan to introduce package solutions and theory bits for each of
the tasks in the outbreak analytics pipeline.</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-read-delays"><p>Content from <a href="read-delays.html">Read delays</a></p>
<hr>
<p>Last updated on 2024-02-08 |
        
        <a href="https://github.com/epiverse-trace/tutorials/edit/main/episodes/read-delays.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How to get delay distributions from a systematic review?</li>
<li>How to connect reused delays with my existing analysis
pipeline?</li>
<li>When should delays be reused from a systematic review?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Get delays from a systematic review with
<code>{epiparameter}</code>.</li>
<li>Get statistical summaries and distribution parameters of delay
distributions.</li>
<li>Use distribution functions from delay distributions.</li>
<li>Convert a continuous to a discrete delay distribution.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="prerequisites" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div id="prerequisites" class="callout-inner">
<h3 class="callout-title">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h3>
<div class="callout-content">
<p>This episode requires you to be familiar with:</p>
<p><strong>Data science</strong> : Basic programming with R.</p>
<p><strong>Epidemic theory</strong> : Epidemiological parameters. Time
periods.</p>
</div>
</div>
</div>
<section id="introduction"><h2 class="section-heading">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>The <a href="reference.html#naturalhistory">natural history</a> of an
infectious disease shows that its development has a regularity from
stage to stage. The time periods from an infectious disease inform about
the timing of transmission and interventions.</p>
<figure><img src="fig/time-periods.jpg" alt="" class="figure mx-auto d-block"><figcaption>Definition of key time periods. From <a href="https://www.sciencedirect.com/science/article/pii/S2468042721000038" class="external-link">Xiang
et al, 2021</a></figcaption></figure><div id="definitions" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="definitions" class="callout-inner">
<h3 class="callout-title">Definitions<a class="anchor" aria-label="anchor" href="#definitions"></a>
</h3>
<div class="callout-content">
<p>Look at the <a href="reference.html">glossary</a> for the definitions
of all the time periods of the figure above!</p>
</div>
</div>
</div>
<p>However, early in an epidemic, modelling efforts can be delayed by
the lack of a centralized resource that summarises input parameters for
the disease of interest (<a href="https://mrc-ide.github.io/epireview/" class="external-link">Nash et al., 2023</a>).
Projects like <code>{epiparameter}</code> and <code>{epireview}</code>
are building online catalogues following systematic review protocols
that can help build models faster for coming outbreaks and epidemics
from known pathogens and unknown ones related to known families of
viruses.</p>
<!-- Early models for COVID-19 used parameters from other coronaviruses. https://www.thelancet.com/article/S1473-3099(20)30144-4/fulltext -->
<p>To exemplify how to use <code>{epiparameter}</code> in your analysis
pipeline, our goal in this episode will be to replace the
<code>generation_time</code> input that we can use for
<code>EpiNow2::epinow()</code>.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">epinow_estimates</span> <span class="op">&lt;-</span> <span class="fu">epinow</span><span class="op">(</span></span>
<span>  <span class="co"># cases</span></span>
<span>  reported_cases <span class="op">=</span> <span class="va">example_confirmed</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">60</span><span class="op">]</span>,</span>
<span>  <span class="co"># delays</span></span>
<span>  generation_time <span class="op">=</span> <span class="fu">generation_time_opts</span><span class="op">(</span><span class="va">generation_time</span><span class="op">)</span>,</span>
<span>  <span class="co"># computation</span></span>
<span>  stan <span class="op">=</span> <span class="fu">stan_opts</span><span class="op">(</span></span>
<span>    cores <span class="op">=</span> <span class="fl">4</span>, samples <span class="op">=</span> <span class="fl">1000</span>, chains <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    control <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<p>To do this replacement, instead of plug-in numeric values to
<code>EpiNow2::dist_spec()</code> to manually specify the delay
distribution parameters, we are going to collect them from the library
of epidemiological parameters provided by
<code>{epiparameter}</code>:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">generation_time</span> <span class="op">&lt;-</span> <span class="fu">dist_spec</span><span class="op">(</span></span>
<span>  mean <span class="op">=</span> <span class="fl">3.6</span>,</span>
<span>  sd <span class="op">=</span> <span class="fl">3.1</span>,</span>
<span>  max <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  distribution <span class="op">=</span> <span class="st">"lognormal"</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<p>Let’s explore how we can access this and other time delays using
<code>{epiparameter}</code>. We’ll use the pipe <code>%&gt;%</code> to
connect some of their functions, so let’s also call to the
<a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a> package:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">epiparameter</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">EpiNow2</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>
</section><section id="find-a-generation-time"><h2 class="section-heading">Find a Generation time<a class="anchor" aria-label="anchor" href="#find-a-generation-time"></a>
</h2>
<hr class="half-width">
<p>The generation time, jointly with the <span class="math inline">\(R\)</span>, can inform about the speed of spread
and its feasibility of control. Given a <span class="math inline">\(R&gt;1\)</span>, with a shorter generation time,
cases can appear more quickly.</p>
<figure><img src="fig/reproduction-generation-time.png" alt="" class="figure mx-auto d-block"><figcaption>Video from the MRC Centre for Global Infectious
Disease Analysis, Ep 76. Science In Context - Epi Parameter Review Group
with Dr Anne Cori (27-07-2023) at <a href="https://youtu.be/VvpYHhFDIjI?si=XiUyjmSV1gKNdrrL" class="external-link uri">https://youtu.be/VvpYHhFDIjI?si=XiUyjmSV1gKNdrrL</a></figcaption></figure><p>In calculating the effective reproduction number (<span class="math inline">\(R_{t}\)</span>), the <em>generation time</em>
distribution is often approximated by the <a href="reference.html#serialinterval">serial interval</a> distribution.
This frequent approximation is because it is easier to observe and
measure the onset of symptoms than the onset of infectiousness.</p>
<figure><img src="fig/serial-interval-observed.jpeg" alt="" class="figure mx-auto d-block"><figcaption>A schematic of the relationship of different time
periods of transmission between an infector and an infectee in a
transmission pair. Exposure window is defined as the time interval
having viral exposure, and transmission window is defined as the time
interval for onward transmission with respect to the infection time (<a href="https://academic.oup.com/jid/article/224/10/1664/6356465" class="external-link">Chung
Lau et al. 2021</a>).</figcaption></figure><p>However, using the <em>serial interval</em> as an approximation of
the <em>generation time</em> is primarily valid for diseases in which
infectiousness starts after symptom onset (<a href="https://academic.oup.com/jid/article/224/10/1664/6356465" class="external-link">Chung
Lau et al. 2021</a>). In cases where infectiousness starts before
symptom onset, the serial intervals can have negative values, which is
the case of a pre-symptomatic transmission (<a href="https://www.ijidonline.com/article/S1201-9712(20)30119-3/fulltext#gr2" class="external-link">Nishiura
et al. (2020)</a>).</p>
<p>Additionally, even if the <em>generation time</em> and <em>serial
interval</em> have the same mean, their variance usually differs,
propagating bias to the <span class="math inline">\(R_{t}\)</span>
estimation. <span class="math inline">\(R_{t}\)</span> estimates are
sensitive not only to the mean generation time but also to the variance
and form of the generation interval distribution <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1008409" class="external-link">(Gostic
et al., 2020)</a>.</p>
<div id="from-time-periods-to-probability-distributions." class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="from-time-periods-to-probability-distributions." class="callout-inner">
<h3 class="callout-title">From time periods to probability
distributions.<a class="anchor" aria-label="anchor" href="#from-time-periods-to-probability-distributions."></a>
</h3>
<div class="callout-content">
<p>When we calculate the <em>serial interval</em>, we see that not all
case pairs have the same time length. We will observe this variability
for any case pair and individual time period, including the <a href="reference.html#incubation">incubation period</a> and <a href="reference.html#infectiousness">infectious period</a>.</p>
<figure><img src="fig/serial-interval-pairs.jpg" alt="" class="figure mx-auto d-block"><figcaption>Serial intervals of possible case pairs in (a)
COVID-19 and (b) MERS-CoV. Pairs represent a presumed infector and their
presumed infectee plotted by date of symptom onset (<a href="https://www.sciencedirect.com/science/article/pii/S2468042722000537#fig6" class="external-link">Althobaity
et al., 2022</a>).</figcaption></figure><p>To summarize these data from individual and pair time periods, we can
find the <strong>statistical distributions</strong> that best fit the
data (<a href="https://www.eurosurveillance.org/content/10.2807/1560-7917.ES.2023.28.27.2200806" class="external-link">McFarland
et al., 2023</a>).</p>
<!-- add a reference about good practices to estimate distributions -->
<figure><img src="fig/seria-interval-fitted-distributions.jpg" alt="" class="figure mx-auto d-block"><figcaption>Fitted serial interval distribution for (a) COVID-19
and (b) MERS-CoV based on reported transmission pairs in Saudi Arabia.
We fitted three commonly used distributions, Lognormal, Gamma, and
Weibull distributions, respectively (<a href="https://www.sciencedirect.com/science/article/pii/S2468042722000537#fig5" class="external-link">Althobaity
et al., 2022</a>).</figcaption></figure><p>Statistical distributions are summarized in terms of their
<strong>summary statistics</strong> like the <em>location</em> (mean and
percentiles) and <em>spread</em> (variance or standard deviation) of the
distribution, or with their <strong>distribution parameters</strong>
that inform about the <em>form</em> (shape and rate/scale) of the
distribution. These estimated values can be reported with their
<strong>uncertainty</strong> (95% confidence intervals).</p>
<table class="table">
<thead><tr class="header">
<th align="left">Gamma</th>
<th align="left">mean</th>
<th align="left">shape</th>
<th align="left">rate/scale</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">MERS-CoV</td>
<td align="left">14.13(13.9–14.7)</td>
<td align="left">6.31(4.88–8.52)</td>
<td align="left">0.43(0.33–0.60)</td>
</tr>
<tr class="even">
<td align="left">COVID-19</td>
<td align="left">5.1(5.0–5.5)</td>
<td align="left">2.77(2.09–3.88)</td>
<td align="left">0.53(0.38–0.76)</td>
</tr>
</tbody>
</table>
<table class="table">
<thead><tr class="header">
<th align="left">Weibull</th>
<th align="left">mean</th>
<th align="left">shape</th>
<th align="left">rate/scale</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">MERS-CoV</td>
<td align="left">14.2(13.3–15.2)</td>
<td align="left">3.07(2.64–3.63)</td>
<td align="left">16.1(15.0–17.1)</td>
</tr>
<tr class="even">
<td align="left">COVID-19</td>
<td align="left">5.2(4.6–5.9)</td>
<td align="left">1.74(1.46–2.11)</td>
<td align="left">5.83(5.08–6.67)</td>
</tr>
</tbody>
</table>
<table class="table">
<caption>Serial interval estimates using Gamma, Weibull, and Log normal
distributions. 95% confidence intervals for the shape and scale (logmean
and sd for Log normal) parameters are shown in brackets (<a href="https://www.sciencedirect.com/science/article/pii/S2468042722000537#tbl3" class="external-link">Althobaity
et al., 2022</a>).</caption>
<thead><tr class="header">
<th align="left">Log normal</th>
<th align="left">mean</th>
<th align="left">mean-log</th>
<th align="left">sd-log</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">MERS-CoV</td>
<td align="left">14.08(13.1–15.2)</td>
<td align="left">2.58(2.50–2.68)</td>
<td align="left">0.44(0.39–0.5)</td>
</tr>
<tr class="even">
<td align="left">COVID-19</td>
<td align="left">5.2(4.2–6.5)</td>
<td align="left">1.45(1.31–1.61)</td>
<td align="left">0.63(0.54–0.74)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="serial-interval" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="serial-interval" class="callout-inner">
<h3 class="callout-title">Serial interval<a class="anchor" aria-label="anchor" href="#serial-interval"></a>
</h3>
<div class="callout-content">
<p>Assume that COVID-19 and SARS have similar reproduction number values
and that the serial interval approximates the generation time.</p>
<p>Given the Serial interval of both infections in the figure below:</p>
<ul>
<li>Which one would be harder to control?</li>
<li>Why do you conclude that?</li>
</ul>
<figure><img src="fig/serial-interval-covid-sars.jpg" alt="" class="figure mx-auto d-block"><figcaption>Serial interval of novel coronavirus (COVID-19)
infections overlaid with a published distribution of SARS. (<a href="https://www.ijidonline.com/article/S1201-9712(20)30119-3/fulltext" class="external-link">Nishiura
et al, 2020</a>)</figcaption></figure>
</div>
</div>
</div>
<div id="accordionHint1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint1" aria-expanded="false" aria-controls="collapseHint1">
  <h4 class="accordion-header" id="headingHint1">Give me a hint</h4>
</button>
<div id="collapseHint1" class="accordion-collapse collapse" data-bs-parent="#accordionHint1" aria-labelledby="headingHint1">
<div class="accordion-body">
<p>The peak of each curve can inform you about the location of the mean
of each distribution. The larger the mean, the larger the serial
interval.</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>Which one would be harder to control?</p>
<ul>
<li>COVID-19</li>
</ul>
<p>Why do you conclude that?</p>
<ul>
<li>COVID-19 has the lowest mean serial interval. The approximate mean
value for the serial interval of COVID-19 is around four days, and SARS
is about seven days. Thus, COVID-19 will likely have newer generations
in less time than SARS, assuming similar reproduction numbers.</li>
</ul>
</div>
</div>
</div>
</div>

</section><section id="extract-epidemiological-parameters"><h2 class="section-heading">Extract epidemiological parameters<a class="anchor" aria-label="anchor" href="#extract-epidemiological-parameters"></a>
</h2>
<hr class="half-width">
<p>First, let’s assume that the data set <code>example_confirmed</code>
has COVID-19 observed cases. So, we need to find a reported generation
time for COVID-19 or any other useful parameter for this aim.</p>
<p>Let’s start by looking at how many parameters we have in the
epidemiological distributions database (<code>epidist_db</code>) for the
<code>disease</code> named <code>covid</code>-19:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"covid"</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Returning 27 results that match the criteria (22 are parameterised). 
Use subset to filter by entry variables or single_epidist to return a single entry. 
To retrieve the short citation for each use the 'get_citation' function</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>List of &lt;epidist&gt; objects
  Number of entries in library: 27
  Number of studies in library: 10
  Number of diseases: 1
  Number of delay distributions: 27
  Number of offspring distributions: 0</code></pre>
</div>
<p>From the <code>{epiparameter}</code> package, we can use the
<code>epidist_db()</code> function to ask for any <code>disease</code>
and also for a specific epidemiological distribution
(<code>epi_dist</code>).</p>
<p>Let’s ask now how many parameters we have in the epidemiological
distributions database (<code>epidist_db</code>) with the generation
time using the string <code>generation</code>:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  epi_dist <span class="op">=</span> <span class="st">"generation"</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Returning 1 results that match the criteria (1 are parameterised). 
Use subset to filter by entry variables or single_epidist to return a single entry. 
To retrieve the short citation for each use the 'get_citation' function</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Disease: Influenza
Pathogen: Influenza-A-H1N1
Epi Distribution: generation time
Study: Lessler J, Reich N, Cummings D, New York City Department of Health and
Mental Hygiene Swine Influenza Investigation Team (2009). "Outbreak of
2009 Pandemic Influenza A (H1N1) at a New York City School." _The New
England Journal of Medicine_. doi:10.1056/NEJMoa0906089
&lt;https://doi.org/10.1056/NEJMoa0906089&gt;.
Distribution: weibull
Parameters:
  shape: 2.360
  scale: 3.180</code></pre>
</div>
<p>Currently, in the library of epidemiological parameters, we have one
<code>generation</code> time entry for Influenza. Considering the
abovementioned considerations, we can look at the <code>serial</code>
intervals for <code>COVID</code>-19.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"COVID"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"serial"</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Returning 4 results that match the criteria (3 are parameterised). 
Use subset to filter by entry variables or single_epidist to return a single entry. 
To retrieve the short citation for each use the 'get_citation' function</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[[1]]
Disease: COVID-19
Pathogen: SARS-CoV-2
Epi Distribution: serial interval
Study: Alene M, Yismaw L, Assemie M, Ketema D, Gietaneh W, Birhan T (2021).
"Serial interval and incubation period of COVID-19: a systematic review
and meta-analysis." _BMC Infectious Diseases_.
doi:10.1186/s12879-021-05950-x
&lt;https://doi.org/10.1186/s12879-021-05950-x&gt;.
Parameters: &lt;no parameters&gt;

[[2]]
Disease: COVID-19
Pathogen: SARS-CoV-2
Epi Distribution: serial interval
Study: Nishiura H, Linton N, Akhmetzhanov A (2020). "Serial interval of novel
coronavirus (COVID-19) infections." _International Journal of
Infectious Diseases_. doi:10.1016/j.ijid.2020.02.060
&lt;https://doi.org/10.1016/j.ijid.2020.02.060&gt;.
Distribution: lnorm
Parameters:
  meanlog: 1.386
  sdlog: 0.568

[[3]]
Disease: COVID-19
Pathogen: SARS-CoV-2
Epi Distribution: serial interval
Study: Nishiura H, Linton N, Akhmetzhanov A (2020). "Serial interval of novel
coronavirus (COVID-19) infections." _International Journal of
Infectious Diseases_. doi:10.1016/j.ijid.2020.02.060
&lt;https://doi.org/10.1016/j.ijid.2020.02.060&gt;.
Distribution: weibull
Parameters:
  shape: 2.203
  scale: 5.420

[[4]]
Disease: COVID-19
Pathogen: SARS-CoV-2
Epi Distribution: serial interval
Study: Yang L, Dai J, Zhao J, Wang Y, Deng P, Wang J (2020). "Estimation of
incubation period and serial interval of COVID-19: analysis of 178
cases and 131 transmission chains in Hubei province, China."
_Epidemiology and Infection_. doi:10.1017/S0950268820001338
&lt;https://doi.org/10.1017/S0950268820001338&gt;.
Distribution: norm
Parameters:
  mean: 4.600
  sd: 4.400

attr(,"class")
[1] "multi_epidist"</code></pre>
</div>
<div id="case-insensitive" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="case-insensitive" class="callout-inner">
<h3 class="callout-title">CASE-INSENSITIVE<a class="anchor" aria-label="anchor" href="#case-insensitive"></a>
</h3>
<div class="callout-content">
<p><code>epidist_db</code> is <a href="https://dillionmegida.com/p/case-sensitivity-vs-case-insensitivity/#case-insensitivity" class="external-link">case-insensitive</a>.
This means that you can use strings with letters in upper or lower case
indistinctly.</p>
</div>
</div>
</div>
<p>We get more than one epidemiological delay. To summarize this view
and get the column names from the underlying parameter dataset, we can
add the <code>epiparameter::list_distributions()</code> function to the
previous code using the pipe <code>%&gt;%</code>:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"covid"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"serial"</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">list_distributions</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Returning 4 results that match the criteria (3 are parameterised). 
Use subset to filter by entry variables or single_epidist to return a single entry. 
To retrieve the short citation for each use the 'get_citation' function</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   disease epi_distribution prob_distribution       author year
1 COVID-19  serial interval              &lt;NA&gt; Muluneh .... 2021
2 COVID-19  serial interval             lnorm Hiroshi .... 2020
3 COVID-19  serial interval           weibull Hiroshi .... 2020
4 COVID-19  serial interval              norm Lin Yang.... 2020</code></pre>
</div>
<div id="ebolas-incubation-periods" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="ebolas-incubation-periods" class="callout-inner">
<h3 class="callout-title">Ebola’s incubation periods<a class="anchor" aria-label="anchor" href="#ebolas-incubation-periods"></a>
</h3>
<div class="callout-content">
<p>Take 5 minutes:</p>
<ul>
<li><p>How many delay distributions are for the Ebola disease?</p></li>
<li><p>How many delay distributions are for the incubation period of
Ebola?</p></li>
<li><p>Explore the library and find the disease with the delay
distribution of your interest! Do you recognize the paper?</p></li>
</ul>
</div>
</div>
</div>
<div id="accordionHint2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint2" aria-expanded="false" aria-controls="collapseHint2">
  <h4 class="accordion-header" id="headingHint2">Give me a hint</h4>
</button>
<div id="collapseHint2" class="accordion-collapse collapse" data-bs-parent="#accordionHint2" aria-labelledby="headingHint2">
<div class="accordion-body">
<p>The <code>{epiparameter}</code> combo of <code>epidist_db()</code>
plus <code>list_distributions()</code> list all the entries by:</p>
<ul>
<li>disease,</li>
<li>epidemiological distribution,</li>
<li>the type of the probability distribution,</li>
<li>author of the study, and</li>
<li>year of study.</li>
</ul>
</div>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 16 delays distributions</span></span>
<span><span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"ebola"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 5 delay distributions are for the incubation period</span></span>
<span><span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"ebola"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"incubation"</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<p>Now, from the output of <code>epiparameter::epidist_db()</code>, What
is an <a href="reference.html#offspringdist">offspring
distribution</a>?</p>
</div>
</div>
</div>
</div>
</section><section id="select-a-single-distribution"><h2 class="section-heading">Select a single distribution<a class="anchor" aria-label="anchor" href="#select-a-single-distribution"></a>
</h2>
<hr class="half-width">
<p>The <code>epiparameter::epidist_db()</code> function works as a
filtering or subset function. Let’s use the <code>author</code> argument
to filter <code>Hiroshi Nishiura</code> parameters:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"covid"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"serial"</span>,</span>
<span>  author <span class="op">=</span> <span class="st">"Hiroshi"</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">list_distributions</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Returning 2 results that match the criteria (2 are parameterised). 
Use subset to filter by entry variables or single_epidist to return a single entry. 
To retrieve the short citation for each use the 'get_citation' function</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   disease epi_distribution prob_distribution       author year
1 COVID-19  serial interval             lnorm Hiroshi .... 2020
2 COVID-19  serial interval           weibull Hiroshi .... 2020</code></pre>
</div>
<p>We still get more than one epidemiological parameter. We can set the
<code>single_epidist</code> argument to <code>TRUE</code> to only
one:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"covid"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"serial"</span>,</span>
<span>  author <span class="op">=</span> <span class="st">"Hiroshi"</span>,</span>
<span>  single_epidist <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Using Nishiura H, Linton N, Akhmetzhanov A (2020). "Serial interval of novel
coronavirus (COVID-19) infections." _International Journal of
Infectious Diseases_. doi:10.1016/j.ijid.2020.02.060
&lt;https://doi.org/10.1016/j.ijid.2020.02.060&gt;.. 
To retrieve the short citation use the 'get_citation' function</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Disease: COVID-19
Pathogen: SARS-CoV-2
Epi Distribution: serial interval
Study: Nishiura H, Linton N, Akhmetzhanov A (2020). "Serial interval of novel
coronavirus (COVID-19) infections." _International Journal of
Infectious Diseases_. doi:10.1016/j.ijid.2020.02.060
&lt;https://doi.org/10.1016/j.ijid.2020.02.060&gt;.
Distribution: lnorm
Parameters:
  meanlog: 1.386
  sdlog: 0.568</code></pre>
</div>
<div id="how-does-single_epidist-works" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="how-does-single_epidist-works" class="callout-inner">
<h3 class="callout-title">How does<code>single_epidist</code>works?<a class="anchor" aria-label="anchor" href="#how-does-single_epidist-works"></a>
</h3>
<div class="callout-content">
<p>Looking at the help documentation for
<code>?epiparameter::epidist_db()</code>:</p>
<ul>
<li>If multiple entries match the arguments supplied and
<code>single_epidist = TRUE</code>,</li>
<li>Then, the parameterised <code>⁠&lt;epidist&gt;</code>⁠ with the
largest sample size will be returned.</li>
<li>If multiple entries are equal after this sorting, the first entry
will be returned.</li>
</ul>
<p>What does a parametrised <code>&lt;epidist&gt;</code> is? Look at
<code>?is_parameterised</code>.</p>
</div>
</div>
</div>
<p>Now, we have an epidemiological parameter we can reuse! We can
replace the numbers we plug into <code>EpiNow2::dist_spec()</code>.</p>
<p>Let’s assign this <code>&lt;epidist&gt;</code> class object to the
<code>covid_serialint</code> object.</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">covid_serialint</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>    disease <span class="op">=</span> <span class="st">"covid"</span>,</span>
<span>    epi_dist <span class="op">=</span> <span class="st">"serial"</span>,</span>
<span>    author <span class="op">=</span> <span class="st">"Nishiura"</span>,</span>
<span>    single_epidist <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Using Nishiura H, Linton N, Akhmetzhanov A (2020). "Serial interval of novel
coronavirus (COVID-19) infections." _International Journal of
Infectious Diseases_. doi:10.1016/j.ijid.2020.02.060
&lt;https://doi.org/10.1016/j.ijid.2020.02.060&gt;.. 
To retrieve the short citation use the 'get_citation' function</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">covid_serialint</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Disease: COVID-19
Pathogen: SARS-CoV-2
Epi Distribution: serial interval
Study: Nishiura H, Linton N, Akhmetzhanov A (2020). "Serial interval of novel
coronavirus (COVID-19) infections." _International Journal of
Infectious Diseases_. doi:10.1016/j.ijid.2020.02.060
&lt;https://doi.org/10.1016/j.ijid.2020.02.060&gt;.
Distribution: lnorm
Parameters:
  meanlog: 1.386
  sdlog: 0.568</code></pre>
</div>
<div id="ebolas-incubation-period" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="ebolas-incubation-period" class="callout-inner">
<h3 class="callout-title">Ebola’s incubation period<a class="anchor" aria-label="anchor" href="#ebolas-incubation-period"></a>
</h3>
<div class="callout-content">
<p>Take 2 minutes:</p>
<ul>
<li>What type of distribution has the incubation period of Ebola with
the highest sample size?</li>
<li>How would you access to the sample size of the other studies in the
<code>&lt;multi_epidist&gt;</code> class object?</li>
</ul>
</div>
</div>
</div>
<div id="accordionHint3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint3" aria-expanded="false" aria-controls="collapseHint3">
  <h4 class="accordion-header" id="headingHint3">Give me a hint</h4>
</button>
<div id="collapseHint3" class="accordion-collapse collapse" data-bs-parent="#accordionHint3" aria-labelledby="headingHint3">
<div class="accordion-body">
<p>The <code>{epiparameter}</code> combo of <code>epidist_db()</code>
plus <code>list_distributions()</code> list all the entries by:</p>
<ul>
<li>disease,</li>
<li>epidemiological distribution,</li>
<li>the type of the probability distribution,</li>
<li>author of the study, and</li>
<li>year of study.</li>
</ul>
<p>This is a <code>&lt;multi_epidist&gt;</code> class object:</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"ebola"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"incubation"</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Show me the solution</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the distribution with the highest sample size has a gamma distribution</span></span>
<span><span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"ebola"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"incubation"</span>,</span>
<span>  single_epidist <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<p>To access the <code>sample_size</code>, review an <a href="https://github.com/epiverse-trace/epiparameter/issues/227" class="external-link">issue
reported in the GitHub repository</a> of the <code>{epiparameter}</code>
package.</p>
</div>
</div>
</div>
</div>
</section><section id="extract-the-summary-statistics"><h2 class="section-heading">Extract the summary statistics<a class="anchor" aria-label="anchor" href="#extract-the-summary-statistics"></a>
</h2>
<hr class="half-width">
<p>We can get the <code>mean</code> and standard deviation
(<code>sd</code>) from this <code>&lt;epidist&gt;</code> diving into the
<code>summary_stats</code> object:</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get the mean</span></span>
<span><span class="va">covid_serialint</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">mean</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 4.7</code></pre>
</div>
<div id="how-to-get-the-sd-and-other-nested-elements" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="how-to-get-the-sd-and-other-nested-elements" class="callout-inner">
<h3 class="callout-title">How to get the<code>sd</code>and other
nested elements?<a class="anchor" aria-label="anchor" href="#how-to-get-the-sd-and-other-nested-elements"></a>
</h3>
<div class="callout-content">
<p>Take 1 minute to:</p>
<ol style="list-style-type: decimal">
<li><p>Get the <code>sd</code> of the epidemiological
distribution.</p></li>
<li><p>Find the <code>sample_size</code> used in the study.</p></li>
<li><p>Explore all the other nested elements within the
<code>&lt;epidist&gt;</code> object.</p></li>
</ol>
<p>Share about:</p>
<ul>
<li>What elements do you find useful for your analysis?</li>
<li>What other elements would you like to see in this object? How?</li>
</ul>
</div>
</div>
</div>
<div id="accordionHint4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint4" aria-expanded="false" aria-controls="collapseHint4">
  <h4 class="accordion-header" id="headingHint4">Give me a hint</h4>
</button>
<div id="collapseHint4" class="accordion-collapse collapse" data-bs-parent="#accordionHint4" aria-labelledby="headingHint4">
<div class="accordion-body">
<p>Use the <code>$</code> operator plus the <kbd>tab</kbd> keyboard
button to explore them as an expandable list:</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>covid_serialint<span class="sc">$</span></span></code></pre>
</div>
<p>Use the <code>str()</code> to display the structure of the
<code>&lt;epidist&gt;</code> R object.</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">Show me the solution</h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get the sd</span></span>
<span><span class="va">covid_serialint</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">sd</span></span>
<span></span>
<span><span class="co"># get the sample_size</span></span>
<span><span class="va">covid_serialint</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">sample_size</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="intructor">
<p>An interesting element is the <code>method_assess</code> nested
entry, which refers to the methods used by the study authors to assess
for bias while estimating the serial interval distribution.</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">covid_serialint</span><span class="op">$</span><span class="va">method_assess</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>$censored
[1] TRUE

$right_truncated
[1] TRUE

$phase_bias_adjusted
[1] FALSE</code></pre>
</div>
<p>We will explore these concepts at the end!</p>
</div>
<div id="ebolas-severity-parameter" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="ebolas-severity-parameter" class="callout-inner">
<h3 class="callout-title">Ebola’s severity parameter<a class="anchor" aria-label="anchor" href="#ebolas-severity-parameter"></a>
</h3>
<div class="callout-content">
<p>A severity parameter like the duration of hospitalization could add
to the information needed about the bed capacity in response to an
outbreak (<a href="https://royalsocietypublishing.org/doi/10.1098/rstb.2016.0371" class="external-link">Cori
et al., 2017</a>).</p>
<p>For Ebola:</p>
<ul>
<li>what is a reported point estimate and uncertainty of the mean
duration of health-care and case isolation?</li>
</ul>
</div>
</div>
</div>
<div id="accordionHint5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint5" aria-expanded="false" aria-controls="collapseHint5">
  <h4 class="accordion-header" id="headingHint5">Give me a hint</h4>
</button>
<div id="collapseHint5" class="accordion-collapse collapse" data-bs-parent="#accordionHint5" aria-labelledby="headingHint5">
<div class="accordion-body">
<p>An informative delay measures the time from symptom onset to recovery
or death.</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">Show me the solution</h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" data-bs-parent="#accordionSolution5" aria-labelledby="headingSolution5">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># one way to get the list of all the available parameters</span></span>
<span><span class="fu">epidist_db</span><span class="op">(</span>disease <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">list_distributions</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">distinct</span><span class="op">(</span><span class="va">epi_distribution</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ebola_severity</span> <span class="op">&lt;-</span> <span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"ebola"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"onset to discharge"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># point estimate</span></span>
<span><span class="va">ebola_severity</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">mean</span></span>
<span><span class="co"># 95% confidence intervals</span></span>
<span><span class="va">ebola_severity</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">mean_ci</span></span>
<span><span class="co"># limits of the confidence intervals</span></span>
<span><span class="va">ebola_severity</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">mean_ci_limits</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="continuous-distributions"><h2 class="section-heading">Continuous distributions<a class="anchor" aria-label="anchor" href="#continuous-distributions"></a>
</h2>
<hr class="half-width">
<p>The following output has four entries with different content in the
<strong>probability distribution</strong>
(<code>prob_distribution</code>) column:</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">distribution</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>    disease <span class="op">=</span> <span class="st">"covid"</span>,</span>
<span>    epi_dist <span class="op">=</span> <span class="st">"serial"</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Returning 4 results that match the criteria (3 are parameterised). 
Use subset to filter by entry variables or single_epidist to return a single entry. 
To retrieve the short citation for each use the 'get_citation' function</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">distribution</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">list_distributions</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   disease epi_distribution prob_distribution       author year
1 COVID-19  serial interval              &lt;NA&gt; Muluneh .... 2021
2 COVID-19  serial interval             lnorm Hiroshi .... 2020
3 COVID-19  serial interval           weibull Hiroshi .... 2020
4 COVID-19  serial interval              norm Lin Yang.... 2020</code></pre>
</div>
<p>Entries with a missing value (<code>&lt;NA&gt;</code>) in the
<code>prob_distribution</code> column are <em>non-parameterised</em>
entries. They have summary statistics but no probability distribution.
Compare these two outputs:</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">distribution</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">summary_stats</span></span>
<span><span class="va">distribution</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">prob_dist</span></span></code></pre>
</div>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div>Parameterised entries have an Inference method</h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler1" aria-labelledby="headingSpoiler1">
<div class="accordion-body">
<p>As detailed in <code>?is_parameterised</code>, a parameterised
distribution is the entry that has a probability distribution associated
with it provided by an <code>inference_method</code> as shown in
<code>metadata</code>:</p>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">distribution</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">inference_method</span></span>
<span><span class="va">distribution</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">inference_method</span></span>
<span><span class="va">distribution</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">inference_method</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>In the <code>epiparameter::list_distributions()</code> output, we can
also find different types of probability distributions (e.g.,
Log-normal, Weibull, Normal).</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">distribution</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">list_distributions</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   disease epi_distribution prob_distribution       author year
1 COVID-19  serial interval              &lt;NA&gt; Muluneh .... 2021
2 COVID-19  serial interval             lnorm Hiroshi .... 2020
3 COVID-19  serial interval           weibull Hiroshi .... 2020
4 COVID-19  serial interval              norm Lin Yang.... 2020</code></pre>
</div>
<p>In <code>{epiparameter}</code>, you will mostly find
<strong>continuous</strong> distributions like these. You can visualize
any of them with the <code>plot()</code> function and access to:</p>
<ul>
<li>the <em>Probability Density Function (PDF)</em> and</li>
<li>the <em>Cumulative Distribution Function (CDF)</em>.</li>
</ul>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">distribution</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/read-delays-rendered-unnamed-chunk-20-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>With the <code>day_range</code> argument, you can change the length
or number of days in the <code>x</code> axis. Explore what it look
like:</p>
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">distribution</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, day_range <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span></span></code></pre>
</div>
<div id="the-distribution-zoo" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="the-distribution-zoo" class="callout-inner">
<h3 class="callout-title">The distribution Zoo<a class="anchor" aria-label="anchor" href="#the-distribution-zoo"></a>
</h3>
<div class="callout-content">
<p>Explore this shinyapp called <strong>The Distribution
Zoo</strong>!</p>
<p>Follow these steps to reproduce the form of the
<code>covid_serialint</code> distribution:</p>
<ol style="list-style-type: decimal">
<li>Access to <a href="https://ben18785.shinyapps.io/distribution-zoo/" class="external-link uri">https://ben18785.shinyapps.io/distribution-zoo/</a> shinyapp
website,</li>
<li>Go to the left panel,</li>
<li>Keep the <em>Category of distribution</em>:
<code>Continuous Univariate</code>,</li>
<li>Select a new <em>Type of distribution</em>:
<code>Log-Normal</code>,</li>
<li>Move the <strong>sliders</strong>, i.e. the graphical control
element that allows you to adjust a value by moving a handle along a
horizontal track or bar to the <code>covid_serialint</code>
parameters.</li>
</ol>
<p>Replicate these with the <code>distribution</code> object and all its
list elements: <code>2</code>, <code>3</code>, and <code>4</code>.
Explore how the shape of a distribution changes when its parameters
change.</p>
<p>Share about:</p>
<ul>
<li>What other features of the website do you find helpful?</li>
</ul>
</div>
</div>
</div>
<!-- A slider, in the context of user interfaces and graphical user interfaces (GUIs), is a graphical control element that allows users to adjust a value by moving a handle along a track or bar. Conceptually, it provides a way to select a numeric value within a specified range by visually sliding or dragging a pointer (the handle) along a continuous axis. -->
</section><section id="distribution-functions"><h2 class="section-heading">Distribution functions<a class="anchor" aria-label="anchor" href="#distribution-functions"></a>
</h2>
<hr class="half-width">
<p>In R, all the statistical distributions have functions to access
the:</p>
<ul>
<li>Probability <strong>Density</strong> function (PDF),</li>
<li>Cumulative Distribution function (<strong>CDF</strong>),</li>
<li>
<strong>Quantile</strong> function, and</li>
<li>
<strong>Random</strong> values from the given distribution.</li>
</ul>
<div id="accordionSpoiler2" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler2" aria-expanded="false" aria-controls="collapseSpoiler2">
  <h3 class="accordion-header" id="headingSpoiler2">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div>Functions for the Normal distribution</h3>
</button>
<div id="collapseSpoiler2" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler2" aria-labelledby="headingSpoiler2">
<div class="accordion-body">
<p>If you need it, read in detail about the <a href="https://sakai.unc.edu/access/content/group/3d1eb92e-7848-4f55-90c3-7c72a54e7e43/public/docs/lectures/lecture13.htm#probfunc" class="external-link">R
probability functions for the normal distribution</a>, each of its
definitions and identify in which part of a distribution they are
located!</p>
<figure><img src="fig/fig5a-normaldistribution.png" alt="" class="figure mx-auto d-block"><figcaption>The four probability functions for the normal
distribution (<a href="https://sakai.unc.edu/access/content/group/3d1eb92e-7848-4f55-90c3-7c72a54e7e43/public/docs/lectures/lecture13.htm#probfunc" class="external-link">Jack
Weiss, 2012</a>)</figcaption></figure>
</div>
</div>
</div>
</div>
<p>If you look at <code>?stats::Distributions</code>, each type of
distribution has a unique set of functions. However,
<code>{epiparameter}</code> gives you the same four functions to access
each of the values above for any <code>&lt;epidist&gt;</code> object you
want!</p>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot this to have a visual reference</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">covid_serialint</span>, day_range <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb47">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the density value at quantile value of 10 (days)</span></span>
<span><span class="fu">density</span><span class="op">(</span><span class="va">covid_serialint</span>, at <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.01911607</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb49">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the cumulative probability at quantile value of 10 (days)</span></span>
<span><span class="fu">cdf</span><span class="op">(</span><span class="va">covid_serialint</span>, q <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.9466605</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb51">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the quantile value (day) at a cumulative probability of 60%</span></span>
<span><span class="fu">quantile</span><span class="op">(</span><span class="va">covid_serialint</span>, p <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 4.618906</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate 10 random values (days) given</span></span>
<span><span class="co"># the distribution family and its parameters</span></span>
<span><span class="fu">generate</span><span class="op">(</span><span class="va">covid_serialint</span>, times <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1] 2.889422 3.306235 3.308088 4.208431 2.248277 2.692921 1.221014 9.998734
 [9] 3.758726 9.042027</code></pre>
</div>

<div id="window-for-contact-tracing-and-the-serial-interval" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="window-for-contact-tracing-and-the-serial-interval" class="callout-inner">
<h3 class="callout-title">Window for contact tracing and the Serial
interval<a class="anchor" aria-label="anchor" href="#window-for-contact-tracing-and-the-serial-interval"></a>
</h3>
<div class="callout-content">
<p>The <strong>serial interval</strong> is important in the optimization
of contact tracing since it provides a time window for the containment
of a disease spread (<a href="https://academic.oup.com/aje/article/158/11/1039/162725" class="external-link">Fine,
2003</a>). Depending on the serial interval, we can evaluate the need to
expand the number of days pre-onset to consider in the contact tracing
to include more backwards contacts (<a href="https://assets.publishing.service.gov.uk/media/61e9ab3f8fa8f50597fb3078/S0523_Oxford_-_Backwards_contact_tracing.pdf" class="external-link">Davis
et al., 2020</a>).</p>
<p>With the COVID-19 serial interval (<code>covid_serialint</code>)
calculate:</p>
<ul>
<li>How much more of the backward cases could be captured if the contact
tracing method considered contacts up to 6 days pre-onset compared to 2
days pre-onset?</li>
</ul>
</div>
</div>
</div>
<div id="accordionHint6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint6" aria-expanded="false" aria-controls="collapseHint6">
  <h4 class="accordion-header" id="headingHint6">Give me a hint</h4>
</button>
<div id="collapseHint6" class="accordion-collapse collapse" data-bs-parent="#accordionHint6" aria-labelledby="headingHint6">
<div class="accordion-body">
<p>In Figure 5 from the <a href="https://sakai.unc.edu/access/content/group/3d1eb92e-7848-4f55-90c3-7c72a54e7e43/public/docs/lectures/lecture13.htm#probfunc" class="external-link">R
probability functions for the normal distribution</a>, the shadowed
section represents a cumulative probability of <code>0.997</code> for
the quantile value at <code>x = 2</code>.</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6">Show me the solution</h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" data-bs-parent="#accordionSolution6" aria-labelledby="headingSolution6">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb55">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">covid_serialint</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb56">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cdf</span><span class="op">(</span><span class="va">covid_serialint</span>, q <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu">cdf</span><span class="op">(</span><span class="va">covid_serialint</span>, q <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></code></pre>
</div>
<p>Given the COVID-19 serial interval:</p>
<ul>
<li><p>A contact tracing method considering contacts up to 2 days
pre-onset will capture around 11.1% of backward cases.</p></li>
<li><p>If this period is extended to 6 days pre-onset, this could
include 76.2% of backward contacts.</p></li>
</ul>
</div>
</div>
</div>
</div>
<div id="accordionSolution7" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution7" aria-expanded="false" aria-controls="collapseSolution7">
  <h4 class="accordion-header" id="headingSolution7">What if</h4>
</button>
<div id="collapseSolution7" class="accordion-collapse collapse" data-bs-parent="#accordionSolution7" aria-labelledby="headingSolution7">
<div class="accordion-body">
<p>If we exchange the question between days and cumulative probability
to:</p>
<ul>
<li>When considering secondary cases, how many days following the
symptom onset of primary cases can we expect 55% of symptom onset to
occur?</li>
</ul>
<div class="codewrapper sourceCode" id="cb57">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">quantile</span><span class="op">(</span><span class="va">covid_serialint</span>, p <span class="op">=</span> <span class="fl">0.55</span><span class="op">)</span></span></code></pre>
</div>
<p>An interpretation could be:</p>
<ul>
<li>The 55% percent of the symptom onset of secondary cases will happen
after 4.2 days after the symptom onset of primary cases.</li>
</ul>
</div>
</div>
</div>
</div>
</section><section id="discretize-a-continuous-distribution"><h2 class="section-heading">Discretize a continuous distribution<a class="anchor" aria-label="anchor" href="#discretize-a-continuous-distribution"></a>
</h2>
<hr class="half-width">
<p>We are getting closer to the end! <code>EpiNow2::dist_spec()</code>
still needs a maximum value (<code>max</code>).</p>
<p>One way to do this is to get the quantile value for the
distribution’s 99.9th percentile or <code>0.999</code> cumulative
probability. For this, we need access to the set of distribution
functions for our <code>&lt;epidist&gt;</code> object.</p>
<p>We can use the set of distribution functions for a
<em>continuous</em> distribution (as above). However, these values will
be <em>continuous</em> numbers. We can <strong>discretize</strong> the
continuous distribution stored in our <code>&lt;epidist&gt;</code>
object to get discrete values from a continuous distribution.</p>
<p>When we <code>epiparameter::discretise()</code> the continuous
distribution we get a <strong>discrete</strong>(-ized) distribution:</p>
<div class="codewrapper sourceCode" id="cb58">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">covid_serialint_discrete</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">discretise</span><span class="op">(</span><span class="va">covid_serialint</span><span class="op">)</span></span>
<span></span>
<span><span class="va">covid_serialint_discrete</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Disease: COVID-19
Pathogen: SARS-CoV-2
Epi Distribution: serial interval
Study: Nishiura H, Linton N, Akhmetzhanov A (2020). "Serial interval of novel
coronavirus (COVID-19) infections." _International Journal of
Infectious Diseases_. doi:10.1016/j.ijid.2020.02.060
&lt;https://doi.org/10.1016/j.ijid.2020.02.060&gt;.
Distribution: discrete lnorm
Parameters:
  meanlog: 1.386
  sdlog: 0.568</code></pre>
</div>
<p>We identify this change in the <code>Distribution:</code> output line
of the <code>&lt;epidist&gt;</code> object. Take a double check to this
line:</p>
<pre><code>Distribution: discrete lnorm</code></pre>
<p>While for a <strong>continuous</strong> distribution, we plot the
<em>Probability Density Function (PDF)</em>, for a
<strong>discrete</strong> distribution, we plot the <em>Probability Mass
Function (PMF)</em>:</p>
<div class="codewrapper sourceCode" id="cb61">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># continuous</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">covid_serialint</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># discrete</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">covid_serialint_discrete</span><span class="op">)</span></span></code></pre>
</div>
<p>To finally get a <code>max</code> value, let’s access the quantile
value of the 99.9th percentile or <code>0.999</code> probability of the
distribution with the <code>prob_dist$q</code> notation, similarly to
how we access the <code>summary_stats</code> values.</p>
<div class="codewrapper sourceCode" id="cb62">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">covid_serialint_discrete_max</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">covid_serialint_discrete</span><span class="op">$</span><span class="va">prob_dist</span><span class="op">$</span><span class="fu">q</span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.999</span><span class="op">)</span></span></code></pre>
</div>
<div id="lenght-of-quarantine-and-incubation-period" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="lenght-of-quarantine-and-incubation-period" class="callout-inner">
<h3 class="callout-title">Lenght of quarantine and Incubation
period<a class="anchor" aria-label="anchor" href="#lenght-of-quarantine-and-incubation-period"></a>
</h3>
<div class="callout-content">
<p>The <strong>incubation period</strong> distribution is a useful delay
to assess the length of active monitoring or quarantine (<a href="https://www.acpjournals.org/doi/10.7326/M20-0504" class="external-link">Lauer et al.,
2020</a>). Similarly, delays from symptom onset to recovery (or death)
will determine the required duration of health-care and case isolation
(<a href="https://royalsocietypublishing.org/doi/10.1098/rstb.2016.0371" class="external-link">Cori
et al., 2017</a>).</p>
<p>Calculate:</p>
<ul>
<li>Within what exact time frame do 99% of individuals who develop
COVID-19 symptoms exhibit them after infection?</li>
</ul>
</div>
</div>
</div>
<div id="accordionHint7" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint7" aria-expanded="false" aria-controls="collapseHint7">
  <h4 class="accordion-header" id="headingHint7">Give me a hint</h4>
</button>
<div id="collapseHint7" class="accordion-collapse collapse" data-bs-parent="#accordionHint7" aria-labelledby="headingHint7">
<div class="accordion-body">
<p>What delay distribution measures the time between infection and the
onset of symptoms?</p>
<p>The probability function for <code>&lt;epidist&gt;</code>
<strong>discrete</strong> distributions differ from the
<em>continuous</em> ones!</p>
<div class="codewrapper sourceCode" id="cb63">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot to have a visual reference</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">covid_serialint_discrete</span>, day_range <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># density value at quantile value 10 (day)</span></span>
<span><span class="va">covid_serialint_discrete</span><span class="op">$</span><span class="va">prob_dist</span><span class="op">$</span><span class="fu">d</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># cumulative probability at quantile value 10 (day)</span></span>
<span><span class="va">covid_serialint_discrete</span><span class="op">$</span><span class="va">prob_dist</span><span class="op">$</span><span class="fu">cdf</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># In what quantile value (days) do we have the 60% cumulative probability?</span></span>
<span><span class="va">covid_serialint_discrete</span><span class="op">$</span><span class="va">prob_dist</span><span class="op">$</span><span class="fu">q</span><span class="op">(</span><span class="fl">0.6</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># generate random values</span></span>
<span><span class="va">covid_serialint_discrete</span><span class="op">$</span><span class="va">prob_dist</span><span class="op">$</span><span class="fu">r</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSolution8" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution8" aria-expanded="false" aria-controls="collapseSolution8">
  <h4 class="accordion-header" id="headingSolution8">Show me the solution</h4>
</button>
<div id="collapseSolution8" class="accordion-collapse collapse" data-bs-parent="#accordionSolution8" aria-labelledby="headingSolution8">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb64">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">covid_incubation</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>    disease <span class="op">=</span> <span class="st">"covid"</span>,</span>
<span>    epi_dist <span class="op">=</span> <span class="st">"incubation"</span>,</span>
<span>    single_epidist <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">covid_incubation_discrete</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">discretise</span><span class="op">(</span><span class="va">covid_incubation</span><span class="op">)</span></span>
<span></span>
<span><span class="va">covid_incubation_discrete</span><span class="op">$</span><span class="va">prob_dist</span><span class="op">$</span><span class="fu">q</span><span class="op">(</span><span class="fl">0.99</span><span class="op">)</span></span></code></pre>
</div>
<p>99% of those who develop COVID-19 symptoms will do so within 16 days
of infection.</p>
<p>Now, <em>Is this result expected in epidemiological terms?</em></p>
</div>
</div>
</div>
</div>
<div id="accordionSolution9" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution9" aria-expanded="false" aria-controls="collapseSolution9">
  <h4 class="accordion-header" id="headingSolution9">how to create a distribution plot?</h4>
</button>
<div id="collapseSolution9" class="accordion-collapse collapse" data-bs-parent="#accordionSolution9" aria-labelledby="headingSolution9">
<div class="accordion-body">
<p>From a maximum value with <code>$prob_dist$q()</code>, we can create
a sequence of quantile values as a numeric vector and map density values
for each:</p>
<div class="codewrapper sourceCode" id="cb65">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a discrete distribution visualization</span></span>
<span><span class="co"># from a maximum value from the distribution</span></span>
<span><span class="va">covid_serialint_discrete</span><span class="op">$</span><span class="va">prob_dist</span><span class="op">$</span><span class="fu">q</span><span class="op">(</span><span class="fl">0.999</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># generate quantile values</span></span>
<span>  <span class="co"># as a sequence for each natural number</span></span>
<span>  <span class="fu">seq</span><span class="op">(</span><span class="fl">1L</span>, to <span class="op">=</span> <span class="va">.</span>, by <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># coerce numeric vector to data frame</span></span>
<span>  <span class="fu">as_tibble_col</span><span class="op">(</span>column_name <span class="op">=</span> <span class="st">"quantile_values"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    <span class="co"># map density values</span></span>
<span>    <span class="co"># for each quantile in the density function</span></span>
<span>    density_values <span class="op">=</span></span>
<span>      <span class="va">covid_serialint_discrete</span><span class="op">$</span><span class="va">prob_dist</span><span class="op">$</span><span class="fu">d</span><span class="op">(</span><span class="va">quantile_values</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># create plot</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span></span>
<span>    <span class="fu">aes</span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">quantile_values</span>,</span>
<span>      y <span class="op">=</span> <span class="va">density_values</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_col</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="plug-in-epiparameter-to-epinow2"><h2 class="section-heading">Plug-in <code>{epiparameter}</code> to <code>{EpiNow2}</code><a class="anchor" aria-label="anchor" href="#plug-in-epiparameter-to-epinow2"></a>
</h2>
<hr class="half-width">
<p>Now we can plug everything into the <code>EpiNow2::dist_spec()</code>
function!</p>
<div class="codewrapper sourceCode" id="cb66">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">serial_interval_covid</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">dist_spec</span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="va">covid_serialint</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">mean</span>,</span>
<span>    sd <span class="op">=</span> <span class="va">covid_serialint</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">sd</span>,</span>
<span>    max <span class="op">=</span> <span class="va">covid_serialint_discrete_max</span>,</span>
<span>    distribution <span class="op">=</span> <span class="st">"lognormal"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">serial_interval_covid</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
  Fixed distribution with PMF [0.18 0.11 0.08 0.066 0.057 0.05 0.045 0.041 0.037 0.034 0.032 0.03 0.028 0.027 0.025 0.024 0.023 0.022 0.021 0.02 0.019 0.019 0.018]</code></pre>
</div>
<div id="warning" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="warning" class="callout-inner">
<h3 class="callout-title">Warning<a class="anchor" aria-label="anchor" href="#warning"></a>
</h3>
<div class="callout-content">
<p>Using the serial interval instead of the generation time is an
alternative that can propagate bias in your estimates, even more so in
diseases with reported pre-symptomatic transmission.</p>
</div>
</div>
</div>
<p>Let’s replace the <code>generation_time</code> input we used for
<code>EpiNow2::epinow()</code>.</p>
<div class="codewrapper sourceCode" id="cb68">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">epinow_estimates</span> <span class="op">&lt;-</span> <span class="fu">epinow</span><span class="op">(</span></span>
<span>  <span class="co"># cases</span></span>
<span>  reported_cases <span class="op">=</span> <span class="va">example_confirmed</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">60</span><span class="op">]</span>,</span>
<span>  <span class="co"># delays</span></span>
<span>  generation_time <span class="op">=</span> <span class="fu">generation_time_opts</span><span class="op">(</span><span class="va">serial_interval_covid</span><span class="op">)</span>,</span>
<span>  <span class="co"># computation</span></span>
<span>  stan <span class="op">=</span> <span class="fu">stan_opts</span><span class="op">(</span></span>
<span>    cores <span class="op">=</span> <span class="fl">4</span>, samples <span class="op">=</span> <span class="fl">1000</span>, chains <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    control <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">base</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span><span class="va">epinow_estimates</span><span class="op">)</span></span></code></pre>
</div>
<div id="ebolas-effective-reproduction-number" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="ebolas-effective-reproduction-number" class="callout-inner">
<h3 class="callout-title">Ebola’s effective reproduction number<a class="anchor" aria-label="anchor" href="#ebolas-effective-reproduction-number"></a>
</h3>
<div class="callout-content">
<p>Download and read the <a href="data/ebola_cases.csv">Ebola
dataset</a>:</p>
<ul>
<li>Reuse one epidemiological parameter to estimate the effective
reproduction number for the Ebola dataset.</li>
<li>Why did you choose that parameter?</li>
</ul>
</div>
</div>
</div>
<div id="accordionHint8" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint8" aria-expanded="false" aria-controls="collapseHint8">
  <h4 class="accordion-header" id="headingHint8">Give me a hint</h4>
</button>
<div id="collapseHint8" class="accordion-collapse collapse" data-bs-parent="#accordionHint8" aria-labelledby="headingHint8">
<div class="accordion-body">
<p>To calculate the <span class="math inline">\(R_t\)</span>, we
need:</p>
<ul>
<li>data set with confirmed cases per day and</li>
<li>one key delay distribution</li>
</ul>
<p>Key functions we applied in this episode are:</p>
<ul>
<li><code>epidist_db()</code></li>
<li><code>list_distributions()</code></li>
<li><code>discretise()</code></li>
<li>probability functions for continuous and discrete distributions</li>
</ul>
</div>
</div>
</div>
</div>
<div id="accordionSolution10" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution10" aria-expanded="false" aria-controls="collapseSolution10">
  <h4 class="accordion-header" id="headingSolution10">Show me the solution</h4>
</button>
<div id="collapseSolution10" class="accordion-collapse collapse" data-bs-parent="#accordionSolution10" aria-labelledby="headingSolution10">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb69">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># read data</span></span>
<span><span class="co"># e.g.: if path to file is data/raw-data/ebola_cases.csv then:</span></span>
<span><span class="va">ebola_confirmed</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">read_csv</span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"raw-data"</span>, <span class="st">"ebola_cases.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># list distributions</span></span>
<span><span class="fu">epidist_db</span><span class="op">(</span>disease <span class="op">=</span> <span class="st">"ebola"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">list_distributions</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># subset one distribution</span></span>
<span><span class="va">ebola_serial</span> <span class="op">&lt;-</span> <span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"ebola"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"serial"</span>,</span>
<span>  single_epidist <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ebola_serial_discrete</span> <span class="op">&lt;-</span> <span class="fu">discretise</span><span class="op">(</span><span class="va">ebola_serial</span><span class="op">)</span></span>
<span></span>
<span><span class="va">serial_interval_ebola</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">dist_spec</span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="va">ebola_serial</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">mean</span>,</span>
<span>    sd <span class="op">=</span> <span class="va">ebola_serial</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">sd</span>,</span>
<span>    max <span class="op">=</span> <span class="va">ebola_serial_discrete</span><span class="op">$</span><span class="va">prob_dist</span><span class="op">$</span><span class="fu">q</span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.999</span><span class="op">)</span>,</span>
<span>    distribution <span class="op">=</span> <span class="st">"gamma"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># name of the type of distribution</span></span>
<span><span class="co"># only for the discretised distribution</span></span>
<span><span class="va">ebola_serial_discrete</span><span class="op">$</span><span class="va">prob_dist</span><span class="op">$</span><span class="va">name</span></span>
<span></span>
<span><span class="va">epinow_estimates</span> <span class="op">&lt;-</span> <span class="fu">epinow</span><span class="op">(</span></span>
<span>  <span class="co"># cases</span></span>
<span>  reported_cases <span class="op">=</span> <span class="va">ebola_confirmed</span>,</span>
<span>  <span class="co"># delays</span></span>
<span>  generation_time <span class="op">=</span> <span class="fu">generation_time_opts</span><span class="op">(</span><span class="va">serial_interval_ebola</span><span class="op">)</span>,</span>
<span>  <span class="co"># computation</span></span>
<span>  stan <span class="op">=</span> <span class="fu">stan_opts</span><span class="op">(</span></span>
<span>    cores <span class="op">=</span> <span class="fl">4</span>, samples <span class="op">=</span> <span class="fl">1000</span>, chains <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    control <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">epinow_estimates</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="adjusting-for-reporting-delays"><h2 class="section-heading">Adjusting for reporting delays<a class="anchor" aria-label="anchor" href="#adjusting-for-reporting-delays"></a>
</h2>
<hr class="half-width">
<p>Estimating <span class="math inline">\(R_t\)</span> requires data on
the daily number of new infections. Due to lags in the development of
detectable viral loads, symptom onset, seeking care, and reporting,
these numbers are not readily available. All observations reflect
transmission events from some time in the past. In other words, if <span class="math inline">\(d\)</span> is the delay from infection to
observation, then observations at time <span class="math inline">\(t\)</span> inform <span class="math inline">\(R_{t−d}\)</span>, not <span class="math inline">\(R_t\)</span>. <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1008409#sec007" class="external-link">(Gostic
et al., 2020)</a></p>
<figure><img src="fig/disease-reporting.jpg" alt="" class="figure mx-auto d-block"><figcaption>Timeline for chain of disease reporting, the
Netherlands. Lab, laboratory; PHA, public health authority. From <a href="https://wwwnc.cdc.gov/eid/article/21/2/13-0504_article" class="external-link">Marinović
et al., 2015</a></figcaption></figure><p>The <strong>delay distribution</strong> could be inferred jointly
with the underlying times of infection or estimated as the sum of the
<strong><a href="reference.html#incubation">incubation
period</a></strong> distribution and the distribution of delays from
symptom onset to observation from line list data <strong>(<a href="reference.html#reportingdelay">reporting delay</a>)</strong>.</p>
<p>For <a href="https://epiforecasts.io/EpiNow2/" class="external-link">EpiNow2</a>, we can specify these two complementary
delay distributions in the <code>delays</code> argument.</p>
<figure><img src="fig/rt-adjusting-delays.png" alt="" class="figure mx-auto d-block"><figcaption>Rt is a measure of transmission at time t.
Observations after time t must be adjusted. ICU, intensive care unit.
From <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1008409#sec007" class="external-link">Gostic
et al., 2020</a></figcaption></figure><div id="reuse-an-incubation-period-for-covid-19" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="reuse-an-incubation-period-for-covid-19" class="callout-inner">
<h3 class="callout-title">Reuse an Incubation period for COVID-19<a class="anchor" aria-label="anchor" href="#reuse-an-incubation-period-for-covid-19"></a>
</h3>
<div class="callout-content">
<p>Use <code>{epiparameter}</code> to:</p>
<ul>
<li>Find an incubation period for COVID-19.</li>
<li>Add our last <code>epinow()</code> code chunk using the
<code>delays</code> argument and the <code>delay_opts()</code> helper
function.</li>
</ul>
</div>
</div>
</div>
<div id="accordionHint9" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint9" aria-expanded="false" aria-controls="collapseHint9">
  <h4 class="accordion-header" id="headingHint9">Give me a hint</h4>
</button>
<div id="collapseHint9" class="accordion-collapse collapse" data-bs-parent="#accordionHint9" aria-labelledby="headingHint9">
<div class="accordion-body">
<p>The <code>delays</code> argument and the <code>delay_opts()</code>
helper function are analogous to the <code>generation_time</code>
argument and the <code>generation_time_opts()</code> helper
function.</p>
<div class="codewrapper sourceCode" id="cb70">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">epinow_estimates</span> <span class="op">&lt;-</span> <span class="fu">epinow</span><span class="op">(</span></span>
<span>  <span class="co"># cases</span></span>
<span>  reported_cases <span class="op">=</span> <span class="va">example_confirmed</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">60</span><span class="op">]</span>,</span>
<span>  <span class="co"># delays</span></span>
<span>  generation_time <span class="op">=</span> <span class="fu">generation_time_opts</span><span class="op">(</span><span class="va">serial_interval_covid</span><span class="op">)</span>,</span>
<span>  delays <span class="op">=</span> <span class="fu">delay_opts</span><span class="op">(</span><span class="va">incubation_time_covid</span><span class="op">)</span>,</span>
<span>  <span class="co"># computation</span></span>
<span>  stan <span class="op">=</span> <span class="fu">stan_opts</span><span class="op">(</span></span>
<span>    cores <span class="op">=</span> <span class="fl">4</span>, samples <span class="op">=</span> <span class="fl">1000</span>, chains <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    control <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSolution11" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution11" aria-expanded="false" aria-controls="collapseSolution11">
  <h4 class="accordion-header" id="headingSolution11">Show me the solution</h4>
</button>
<div id="collapseSolution11" class="accordion-collapse collapse" data-bs-parent="#accordionSolution11" aria-labelledby="headingSolution11">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb71">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">covid_incubation</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"covid"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"incubation"</span>,</span>
<span>  author <span class="op">=</span> <span class="st">"Natalie"</span>,</span>
<span>  single_epidist <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">covid_incubation</span></span>
<span></span>
<span><span class="va">covid_incubation_discrete</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">discretise</span><span class="op">(</span><span class="va">covid_incubation</span><span class="op">)</span></span>
<span></span>
<span><span class="va">incubation_time_covid</span> <span class="op">&lt;-</span> <span class="fu">dist_spec</span><span class="op">(</span></span>
<span>  mean <span class="op">=</span> <span class="va">covid_incubation</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">mean</span>,</span>
<span>  sd <span class="op">=</span> <span class="va">covid_incubation</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">sd</span>,</span>
<span>  max <span class="op">=</span> <span class="va">covid_incubation_discrete</span><span class="op">$</span><span class="va">prob_dist</span><span class="op">$</span><span class="fu">q</span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.999</span><span class="op">)</span>,</span>
<span>  distribution <span class="op">=</span> <span class="st">"lognormal"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">epinow_estimates</span> <span class="op">&lt;-</span> <span class="fu">epinow</span><span class="op">(</span></span>
<span>  <span class="co"># cases</span></span>
<span>  reported_cases <span class="op">=</span> <span class="va">example_confirmed</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">60</span><span class="op">]</span>,</span>
<span>  <span class="co"># delays</span></span>
<span>  generation_time <span class="op">=</span> <span class="fu">generation_time_opts</span><span class="op">(</span><span class="va">serial_interval_covid</span><span class="op">)</span>,</span>
<span>  delays <span class="op">=</span> <span class="fu">delay_opts</span><span class="op">(</span><span class="va">incubation_time_covid</span><span class="op">)</span>,</span>
<span>  <span class="co"># computation</span></span>
<span>  stan <span class="op">=</span> <span class="fu">stan_opts</span><span class="op">(</span></span>
<span>    cores <span class="op">=</span> <span class="fl">4</span>, samples <span class="op">=</span> <span class="fl">1000</span>, chains <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    control <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">base</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span><span class="va">epinow_estimates</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSolution12" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution12" aria-expanded="false" aria-controls="collapseSolution12">
  <h4 class="accordion-header" id="headingSolution12">How much has it changed?</h4>
</button>
<div id="collapseSolution12" class="accordion-collapse collapse" data-bs-parent="#accordionSolution12" aria-labelledby="headingSolution12">
<div class="accordion-body">
<p>After adding the incubation period, discuss:</p>
<ul>
<li>Does the retrospective trend of forecast change?</li>
<li>Has the uncertainty changed?</li>
<li>How would you explain or interpret any of these changes?</li>
</ul>
</div>
</div>
</div>
</div>
<div id="ebolas-effective-reproduction-number-was-adjusted-by-reporting-delays" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="ebolas-effective-reproduction-number-was-adjusted-by-reporting-delays" class="callout-inner">
<h3 class="callout-title">Ebola’s effective reproduction number was
adjusted by reporting delays<a class="anchor" aria-label="anchor" href="#ebolas-effective-reproduction-number-was-adjusted-by-reporting-delays"></a>
</h3>
<div class="callout-content">
<p>Using the same <a href="data/ebola_cases.csv">Ebola dataset</a>:</p>
<ul>
<li>Reuse one additional epidemiological parameter for the
<code>delays</code> argument in <code>EpiNow2::epinow()</code>.</li>
<li>Estimate the effective reproduction number using
<code>EpiNow2::epinow()</code>.</li>
<li>Why did you choose that parameter?</li>
</ul>
</div>
</div>
</div>
<div id="accordionHint10" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint10" aria-expanded="false" aria-controls="collapseHint10">
  <h4 class="accordion-header" id="headingHint10">Give me a hint</h4>
</button>
<div id="collapseHint10" class="accordion-collapse collapse" data-bs-parent="#accordionHint10" aria-labelledby="headingHint10">
<div class="accordion-body">
<p>We can use two complementary delay distributions to estimate the
<span class="math inline">\(R_t\)</span> at time <span class="math inline">\(t\)</span>.</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution13" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution13" aria-expanded="false" aria-controls="collapseSolution13">
  <h4 class="accordion-header" id="headingSolution13">Show me the solution</h4>
</button>
<div id="collapseSolution13" class="accordion-collapse collapse" data-bs-parent="#accordionSolution13" aria-labelledby="headingSolution13">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb72">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># read data</span></span>
<span><span class="co"># e.g.: if path to file is data/raw-data/ebola_cases.csv then:</span></span>
<span><span class="va">ebola_confirmed</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">read_csv</span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"raw-data"</span>, <span class="st">"ebola_cases.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># list distributions</span></span>
<span><span class="fu">epidist_db</span><span class="op">(</span>disease <span class="op">=</span> <span class="st">"ebola"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">list_distributions</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># subset one distribution for the generation time</span></span>
<span><span class="va">ebola_serial</span> <span class="op">&lt;-</span> <span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"ebola"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"serial"</span>,</span>
<span>  single_epidist <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ebola_serial_discrete</span> <span class="op">&lt;-</span> <span class="fu">discretise</span><span class="op">(</span><span class="va">ebola_serial</span><span class="op">)</span></span>
<span></span>
<span><span class="va">serial_interval_ebola</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">dist_spec</span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="va">ebola_serial</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">mean</span>,</span>
<span>    sd <span class="op">=</span> <span class="va">ebola_serial</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">sd</span>,</span>
<span>    max <span class="op">=</span> <span class="va">ebola_serial_discrete</span><span class="op">$</span><span class="va">prob_dist</span><span class="op">$</span><span class="fu">q</span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.999</span><span class="op">)</span>,</span>
<span>    distribution <span class="op">=</span> <span class="st">"gamma"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># subset one distribution for delay of the incubation period</span></span>
<span><span class="va">ebola_incubation</span> <span class="op">&lt;-</span> <span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"ebola"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"incubation"</span>,</span>
<span>  single_epidist <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ebola_incubation_discrete</span> <span class="op">&lt;-</span> <span class="fu">discretise</span><span class="op">(</span><span class="va">ebola_incubation</span><span class="op">)</span></span>
<span></span>
<span><span class="va">incubation_period_ebola</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">dist_spec</span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="va">ebola_incubation</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">mean</span>,</span>
<span>    sd <span class="op">=</span> <span class="va">ebola_incubation</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">sd</span>,</span>
<span>    max <span class="op">=</span> <span class="va">ebola_incubation_discrete</span><span class="op">$</span><span class="va">prob_dist</span><span class="op">$</span><span class="fu">q</span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.999</span><span class="op">)</span>,</span>
<span>    distribution <span class="op">=</span> <span class="st">"gamma"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">epinow_estimates</span> <span class="op">&lt;-</span> <span class="fu">epinow</span><span class="op">(</span></span>
<span>  <span class="co"># cases</span></span>
<span>  reported_cases <span class="op">=</span> <span class="va">ebola_confirmed</span>,</span>
<span>  <span class="co"># delays</span></span>
<span>  generation_time <span class="op">=</span> <span class="fu">generation_time_opts</span><span class="op">(</span><span class="va">serial_interval_ebola</span><span class="op">)</span>,</span>
<span>  delays <span class="op">=</span> <span class="fu">delay_opts</span><span class="op">(</span><span class="va">incubation_period_ebola</span><span class="op">)</span>,</span>
<span>  <span class="co"># computation</span></span>
<span>  stan <span class="op">=</span> <span class="fu">stan_opts</span><span class="op">(</span></span>
<span>    cores <span class="op">=</span> <span class="fl">4</span>, samples <span class="op">=</span> <span class="fl">1000</span>, chains <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    control <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">epinow_estimates</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="extract-parameters" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="extract-parameters" class="callout-inner">
<h3 class="callout-title">Extract parameters<a class="anchor" aria-label="anchor" href="#extract-parameters"></a>
</h3>
<div class="callout-content">
<p>Use the <code>influenza_england_1978_school</code> from the
<a href="https://github.com/reconhub/outbreaks" class="external-link">outbreaks</a> package to calculate the effective reproduction
number.</p>
</div>
</div>
</div>
<div id="accordionHint11" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint11" aria-expanded="false" aria-controls="collapseHint11">
  <h4 class="accordion-header" id="headingHint11">Give me a hint</h4>
</button>
<div id="collapseHint11" class="accordion-collapse collapse" data-bs-parent="#accordionHint11" aria-labelledby="headingHint11">
<div class="accordion-body">
<p>How to get the mean and standard deviation from a generation time
with median and quantiles as summary statistics?</p>
<ul>
<li>Look at how to extract parameters from <code>{epiparameter}</code>
vignette on <a href="https://epiverse-trace.github.io/epiparameter/articles/extract_convert.html" class="external-link">parameter
extraction and conversion</a>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="accordionSolution14" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution14" aria-expanded="false" aria-controls="collapseSolution14">
  <h4 class="accordion-header" id="headingSolution14">Show me the solution</h4>
</button>
<div id="collapseSolution14" class="accordion-collapse collapse" data-bs-parent="#accordionSolution14" aria-labelledby="headingSolution14">
<div class="accordion-body">
<!-- https://github.com/epiverse-trace/epiparameter/issues/114 -->
<div class="codewrapper sourceCode" id="cb73">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># What parameters are available for Influenza?</span></span>
<span><span class="fu">epidist_db</span><span class="op">(</span>disease <span class="op">=</span> <span class="st">"influenza"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">list_distributions</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">epi_distribution</span><span class="op">)</span></span>
<span></span>
<span><span class="va">influenza_generation</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">epidist_db</span><span class="op">(</span></span>
<span>    disease <span class="op">=</span> <span class="st">"influenza"</span>,</span>
<span>    epi_dist <span class="op">=</span> <span class="st">"generation"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">influenza_generation_discrete</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">discretise</span><span class="op">(</span><span class="va">influenza_generation</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># problem</span></span>
<span><span class="co"># the summary statistics do not have mean and sd</span></span>
<span><span class="va">influenza_generation</span><span class="op">$</span><span class="va">summary_stats</span></span>
<span><span class="va">influenza_generation</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">median</span></span>
<span><span class="va">influenza_generation</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">quantiles</span></span>
<span></span>
<span><span class="co"># solution</span></span>
<span><span class="co"># extract parameters from percentiles</span></span>
<span><span class="va">influenza_extracted</span> <span class="op">&lt;-</span> <span class="fu">extract_param</span><span class="op">(</span></span>
<span>  type <span class="op">=</span> <span class="st">"percentiles"</span>,</span>
<span>  values <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="va">influenza_generation</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">quantiles</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>             <span class="va">influenza_generation</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">quantiles</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  distribution <span class="op">=</span> <span class="st">"lnorm"</span>,</span>
<span>  percentiles <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">influenza_extracted</span></span>
<span></span>
<span><span class="va">generation_time_influenza</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">dist_spec</span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="va">influenza_extracted</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    sd <span class="op">=</span> <span class="va">influenza_extracted</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>    max <span class="op">=</span> <span class="va">influenza_generation_discrete</span><span class="op">$</span><span class="va">prob_dist</span><span class="op">$</span><span class="fu">q</span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.999</span><span class="op">)</span>,</span>
<span>    distribution <span class="op">=</span> <span class="st">"lognormal"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">influenza_cleaned</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">outbreaks</span><span class="fu">::</span><span class="va">influenza_england_1978_school</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">date</span>, confirm <span class="op">=</span> <span class="va">in_bed</span><span class="op">)</span></span>
<span></span>
<span><span class="va">epinow_estimates</span> <span class="op">&lt;-</span> <span class="fu">epinow</span><span class="op">(</span></span>
<span>  <span class="co"># cases</span></span>
<span>  reported_cases <span class="op">=</span> <span class="va">influenza_cleaned</span>,</span>
<span>  <span class="co"># delays</span></span>
<span>  generation_time <span class="op">=</span> <span class="fu">generation_time_opts</span><span class="op">(</span><span class="va">generation_time_influenza</span><span class="op">)</span>,</span>
<span>  <span class="co"># computation</span></span>
<span>  stan <span class="op">=</span> <span class="fu">stan_opts</span><span class="op">(</span></span>
<span>    cores <span class="op">=</span> <span class="fl">4</span>, samples <span class="op">=</span> <span class="fl">1000</span>, chains <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    control <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">epinow_estimates</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="when-to-reuse-when-to-estimate"><h2 class="section-heading">When to reuse? When to estimate?<a class="anchor" aria-label="anchor" href="#when-to-reuse-when-to-estimate"></a>
</h2>
<hr class="half-width">
<p>In the early stage of an outbreak, we can rely on reusing parameters
for known pathogens to unknown ones, like for the <a href="https://en.wikipedia.org/wiki/Disease_X" class="external-link">Disease X</a>, a pathogen
currently unknown to cause human disease and potentially cause a serious
international epidemic (<a href="https://www.who.int/activities/prioritizing-diseases-for-research-and-development-in-emergency-contexts" class="external-link">WHO,
2018</a>).</p>
<p>But when data from <strong>lines list paired with contact
tracing</strong> is available, we can estimate the key delay
distributions that best fit our data. These will help us to inform,
compare and update any previous estimate about questions like:</p>
<ul>
<li>How long should contacts be followed?</li>
<li>What is the required duration of contact tracing?</li>
<li>How long should cases be isolated to reduce transmission?</li>
</ul>
<p>However, the methods to accurately estimate delays like the
generation interval from contact tracing data involve adjusting for
biases like <strong><a href="reference.html#censoring">censoring</a></strong>, <strong><a href="reference.html#truncation">right truncation</a></strong> and
<strong><a href="reference.html#phasebias">epidemic phase
bias</a></strong>. <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1008409" class="external-link">(Gostic
et al., 2020)</a></p>
<p>We can identify what entries in the <code>{epiparameter}</code>
library assessed for these biases in their methodology with the
<code>method_assess</code> nested entry:</p>
<div class="codewrapper sourceCode" id="cb74">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">covid_serialint</span><span class="op">$</span><span class="va">method_assess</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>$censored
[1] TRUE

$right_truncated
[1] TRUE

$phase_bias_adjusted
[1] FALSE</code></pre>
</div>
<div id="how-to-estimate-delay-distributions-for-disease-x" class="callout testimonial">
<div class="callout-square">
<i class="callout-icon" data-feather="heart"></i>
</div>
<div id="how-to-estimate-delay-distributions-for-disease-x" class="callout-inner">
<h3 class="callout-title">How to estimate delay distributions for
Disease X?<a class="anchor" aria-label="anchor" href="#how-to-estimate-delay-distributions-for-disease-x"></a>
</h3>
<div class="callout-content">
<p>Refer to this excellent tutorial on estimating the serial interval
and incubation period of Disease X accounting for <em>censoring</em>
using Bayesian inference with packages like <a href="https://mc-stan.org/rstan/" class="external-link">rstan</a> and
<a href="https://cran.r-project.org/package=coarseDataTools" class="external-link">coarseDataTools</a>.</p>
<ul>
<li>Tutorial in English: <a href="https://rpubs.com/tracelac/diseaseX" class="external-link uri">https://rpubs.com/tracelac/diseaseX</a>
<!-- to request -->
</li>
<li>Tutorial en Español: <a href="https://epiverse-trace.github.io/epimodelac/EnfermedadX.html" class="external-link uri">https://epiverse-trace.github.io/epimodelac/EnfermedadX.html</a>
</li>
</ul>
</div>
</div>
</div>
<div id="accordionSpoiler3" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler3" aria-expanded="false" aria-controls="collapseSpoiler3">
  <h3 class="accordion-header" id="headingSpoiler3">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div>How to assess for pre-symptomatic infection?</h3>
</button>
<div id="collapseSpoiler3" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler3" aria-labelledby="headingSpoiler3">
<div class="accordion-body">
<p>The lengths of the Serial interval and Incubation period determine
the type of disease transmission.</p>
<figure><img src="fig/incubation-period-serial-interval.jpg" alt="" class="figure mx-auto d-block"><figcaption>The relationship between the incubation period and
serial interval. From <a href="https://www.ijidonline.com/article/S1201-9712(20)30119-3/fulltext" class="external-link">Nishiura
2020</a></figcaption></figure><p>Estimating the proportion of pre-symptomatic infections, or the
extent to which infectiousness precedes symptom onset will determine the
effectiveness of contact tracing and the feasibility of controlling an
outbreak (<a href="https://www.pnas.org/doi/full/10.1073/pnas.0307506101" class="external-link">Fraser et
al., 2004</a> and <a href="https://www.thelancet.com/article/S2214-109X(20)30074-7/fulltext" class="external-link">Hellewell
et al., 2020</a>).</p>
<!-- The proportion of pre-symptomatic transmission contributes to the effective reproduction number and expected new cases. -->
<figure><img src="fig/reproduction-number-pre-symptomatic.png" alt="" class="figure mx-auto d-block"><figcaption>Parameter estimates. Plausible ranges for the key
parameters R0 and θ (read the main text for sources) for four viral
infections of public concern are shown as shaded regions. The size of
the shaded area reflects the uncertainties in the parameter estimates.
<a href="https://www.pnas.org/doi/10.1073/pnas.0307506101" class="external-link">Fraser et
al., 2004</a></figcaption></figure><p>Meta-analysis on the proportion of pre-symptomatic and asymptomatic
transmission in SARS-CoV-2 found limitations of the evidence given high
heterogeneity and high risk of selection and information bias between
studies (<a href="https://journals.plos.org/plosmedicine/article/figure?id=10.1371/journal.pmed.1003987.g003" class="external-link">Buitrago-Garcia
et al., 2022</a>). This is a call to action to improve the Outbreak
Analytic pipelines to use and reuse in the early phase of an
outbreak.</p>
</div>
</div>
</div>
</div>
<div id="what-type-of-transmission" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="what-type-of-transmission" class="callout-inner">
<h3 class="callout-title">What type of transmission?<a class="anchor" aria-label="anchor" href="#what-type-of-transmission"></a>
</h3>
<div class="callout-content">
<p>Compare the serial interval and incubation period of Influenza and
MERS:</p>
<ul>
<li>What type of transmission has Influenza?</li>
<li>What type of transmission has MERS?</li>
<li>Do these results correlate with the available evidence?</li>
</ul>
</div>
</div>
</div>
<div id="accordionHint12" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint12" aria-expanded="false" aria-controls="collapseHint12">
  <h4 class="accordion-header" id="headingHint12">Give me a hint</h4>
</button>
<div id="collapseHint12" class="accordion-collapse collapse" data-bs-parent="#accordionHint12" aria-labelledby="headingHint12">
<div class="accordion-body">
<p>For types of transmission, we refer to infections with symptomatic or
pre-symptomatic transmission.</p>
<p>Key functions:</p>
<ul>
<li><code>epidist_db()</code></li>
<li><code>epidist$summary_stats$</code></li>
</ul>
</div>
</div>
</div>
</div>
<div id="accordionSolution15" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution15" aria-expanded="false" aria-controls="collapseSolution15">
  <h4 class="accordion-header" id="headingSolution15">Show me the solution</h4>
</button>
<div id="collapseSolution15" class="accordion-collapse collapse" data-bs-parent="#accordionSolution15" aria-labelledby="headingSolution15">
<div class="accordion-body">
<p>In this solution we use <code>purrr::pluck()</code> to extract
elements within the <code>summary_stats</code> object which is of class
<code>list</code>.</p>
<div class="codewrapper sourceCode" id="cb76">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># pre-symptomatic transmission</span></span>
<span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"influenza"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"incubation"</span>,</span>
<span>  single_epidist <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pluck</span><span class="op">(</span><span class="st">"summary_stats"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pluck</span><span class="op">(</span><span class="st">"mean"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"influenza"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"serial"</span>,</span>
<span>  single_epidist <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pluck</span><span class="op">(</span><span class="st">"summary_stats"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pluck</span><span class="op">(</span><span class="st">"mean"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># symptomatic transmission</span></span>
<span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"mers"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"incubation"</span>,</span>
<span>  single_epidist <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pluck</span><span class="op">(</span><span class="st">"summary_stats"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pluck</span><span class="op">(</span><span class="st">"median"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"mers"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"serial"</span>,</span>
<span>  single_epidist <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pluck</span><span class="op">(</span><span class="st">"summary_stats"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pluck</span><span class="op">(</span><span class="st">"mean"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb77">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># pre-symptomatic transmission</span></span>
<span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"covid"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"incubation"</span>,</span>
<span>  author <span class="op">=</span> <span class="st">"Stephen"</span>,</span>
<span>  single_epidist <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pluck</span><span class="op">(</span><span class="st">"summary_stats"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pluck</span><span class="op">(</span><span class="st">"mean"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"covid"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"serial"</span>,</span>
<span>  author <span class="op">=</span> <span class="st">"Nishiura"</span>,</span>
<span>  single_epidist <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pluck</span><span class="op">(</span><span class="st">"summary_stats"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pluck</span><span class="op">(</span><span class="st">"mean"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># symptomatic transmission</span></span>
<span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"ebola"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"incubation"</span>,</span>
<span>  single_epidist <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pluck</span><span class="op">(</span><span class="st">"summary_stats"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pluck</span><span class="op">(</span><span class="st">"mean"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"ebola"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"serial"</span>,</span>
<span>  single_epidist <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pluck</span><span class="op">(</span><span class="st">"summary_stats"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pluck</span><span class="op">(</span><span class="st">"mean"</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<!--
## Concept map

update it from last epiparameter test 
-->
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use <code>{epiparameter}</code> to access the systematic review
catalogue of epidemiological delay distributions.</li>
<li>Use <code>epidist_db()</code> to select single delay
distributions.</li>
<li>Use <code>list_distributions()</code> for an overview of multiple
delay distributions.</li>
<li>Use <code>discretise()</code> to convert continuous to discrete
delay distributions.</li>
<li>Use <code>{epiparameter}</code> probability functions for any delay
distributions.</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-quantify-transmissibility"><p>Content from <a href="quantify-transmissibility.html">Quantifying transmission</a></p>
<hr>
<p>Last updated on 2024-02-08 |
        
        <a href="https://github.com/epiverse-trace/tutorials/edit/main/episodes/quantify-transmissibility.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I estimate key transmission metrics from a time series of
case data?</li>
<li>How can I quantify geographical heterogeneity in these metrics?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Learn how to estimate transmission metrics from a time series of
case data using the R package <code>EpiNow2</code>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="prerequisites" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div id="prerequisites" class="callout-inner">
<h3 class="callout-title">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h3>
<div class="callout-content">
<p>Learners should familiarise themselves with following concept
dependencies before working through this tutorial:</p>
<p><strong>Statistics</strong> : probability distributions, principle of
Bayesian analysis.</p>
<p><strong>Epidemic theory</strong> : Effective reproduction number.</p>
</div>
</div>
</div>
<div id="reminder-the-effective-reproduction-number-r_t" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="reminder-the-effective-reproduction-number-r_t" class="callout-inner">
<h3 class="callout-title">Reminder: the Effective Reproduction Number,<span class="math inline">\(R_t\)</span><a class="anchor" aria-label="anchor" href="#reminder-the-effective-reproduction-number-r_t"></a>
</h3>
<div class="callout-content">
<p>The <a href="reference.html#basic">basic reproduction number</a>,
<span class="math inline">\(R_0\)</span>, is the average number of cases
caused by one infectious individual in a entirely susceptible
population.</p>
<p>But in an ongoing outbreak, the population does not remain entirely
susceptible as those that recover from infection are typically immune.
Moreover, there can be changes in behaviour or other factors that affect
transmission. When we are interested in monitoring changes in
transmission we are therefore more interested in the value of the
<strong>effective reproduction number</strong>, <span class="math inline">\(R_t\)</span>, the average number of cases caused
by one infectious individual in the population at time <span class="math inline">\(t\)</span>.</p>
</div>
</div>
</div>
<section id="introduction"><h2 class="section-heading">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>Quantifying transmission metrics at the start of an outbreak can give
important information on the strength of transmission (reproduction
number) and the speed of transmission (<a href="reference.html#growth">growth rate</a>, doubling/halving time). To
estimate these key metrics using case data we must account for delays
between the date of infections and date of reported cases. In an
outbreak situation, data are usually available on reported dates only,
therefore we must use estimation methods to account for these delays
when trying to understand changes in transmission over time.</p>
<p>In the next tutorials we will focus on how to implement the functions
in <a href="https://epiforecasts.io/EpiNow2/" class="external-link">EpiNow2</a> to estimate transmission metrics of case data.
We will not cover the theoretical background of the models or inference
framework, for details on these concepts see the <a href="https://epiforecasts.io/EpiNow2/dev/articles/estimate_infections.html" class="external-link">vignette</a>.
For more details on the distinction between speed and strength of
transmission and implications for control, see <a href="https://royalsocietypublishing.org/doi/full/10.1098/rspb.2020.1556" class="external-link">Dushoff
&amp; Park, 2021</a>.</p>
<div id="bayesian-inference" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="bayesian-inference" class="callout-inner">
<h3 class="callout-title">Bayesian inference<a class="anchor" aria-label="anchor" href="#bayesian-inference"></a>
</h3>
<div class="callout-content">
<p>The R package <code>EpiNow2</code> uses a <a href="reference.html#bayesian">Bayesian inference</a> framework to
estimate reproduction numbers and infection times based on reporting
dates.</p>
<p>In Bayesian inference, we use prior knowledge (prior distributions)
with data (in a likelihood function) to find the posterior
probability.</p>
<p class="text-center" style="background-color: white">
Posterior probability <span class="math inline">\(\propto\)</span>
likelihood <span class="math inline">\(\times\)</span> prior probability
</p>
</div>
</div>
</div>
<p>The first step is to load the <a href="https://epiforecasts.io/EpiNow2/" class="external-link">EpiNow2</a> package :</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">EpiNow2</span><span class="op">)</span></span></code></pre>
</div>

</section><section id="delay-distributions-and-case-data"><h2 class="section-heading">Delay distributions and case data<a class="anchor" aria-label="anchor" href="#delay-distributions-and-case-data"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="case-data">Case data<a class="anchor" aria-label="anchor" href="#case-data"></a>
</h3>
<p>To illustrate the functions of <code>EpiNow2</code> we will use
outbreak data of the start of the COVID-19 pandemic from the United
Kingdom. The data are available in the R package
<a href="https://www.reconverse.org/incidence2/" class="external-link">incidence2</a>.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="fu">incidence2</span><span class="fu">::</span><span class="va">covidregionaldataUK</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>        date          region region_code cases_new cases_total deaths_new
1 2020-01-30   East Midlands   E12000004        NA          NA         NA
2 2020-01-30 East of England   E12000006        NA          NA         NA
3 2020-01-30         England   E92000001         2           2         NA
4 2020-01-30          London   E12000007        NA          NA         NA
5 2020-01-30      North East   E12000001        NA          NA         NA
6 2020-01-30      North West   E12000002        NA          NA         NA
  deaths_total recovered_new recovered_total hosp_new hosp_total tested_new
1           NA            NA              NA       NA         NA         NA
2           NA            NA              NA       NA         NA         NA
3           NA            NA              NA       NA         NA         NA
4           NA            NA              NA       NA         NA         NA
5           NA            NA              NA       NA         NA         NA
6           NA            NA              NA       NA         NA         NA
  tested_total
1           NA
2           NA
3           NA
4           NA
5           NA
6           NA</code></pre>
</div>
<p>To use the data, we must format the data to have two columns:</p>
<ul>
<li>
<code>date</code> : the date (as a date object see
<code>?is.Date()</code>),</li>
<li>
<code>confirm</code> : number of confirmed cases on that date.</li>
</ul>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cases</span> <span class="op">&lt;-</span> <span class="fu">aggregate</span><span class="op">(</span></span>
<span>  <span class="va">cases_new</span> <span class="op">~</span> <span class="va">date</span>,</span>
<span>  data <span class="op">=</span> <span class="fu">incidence2</span><span class="fu">::</span><span class="va">covidregionaldataUK</span><span class="op">[</span>, <span class="fu">c</span><span class="op">(</span><span class="st">"date"</span>, <span class="st">"cases_new"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  FUN <span class="op">=</span> <span class="va">sum</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">colnames</span><span class="op">(</span><span class="va">cases</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"date"</span>, <span class="st">"confirm"</span><span class="op">)</span></span></code></pre>
</div>
<p>There are case data available for 489 days, but in an outbreak
situation it is likely we would only have access to the beginning of
this data set. Therefore we assume we only have the first 90 days of
this data.</p>
<figure><img src="fig/quantify-transmissibility-rendered-unnamed-chunk-4-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="delay-distributions">Delay distributions<a class="anchor" aria-label="anchor" href="#delay-distributions"></a>
</h3>
<p>We assume there are delays from the time of infection until the time
a case is reported. We specify these delays as distributions to account
for the uncertainty in individual level differences. The delay can
consist of multiple types of delays/processes. A typical delay from time
of infection to case reporting may consist of :</p>
<p class="text-center" style="background-color: aliceblue">
<strong>time from infection to symptom onset</strong> (the <a href="reference.html#incubation">incubation period</a>) + <strong>time
from symptom onset to case notification</strong> (the reporting time) .
</p>
<p>The delay distribution for each of these processes can either
estimated from data or obtained from the literature. We can express
uncertainty about what the correct parameters of the distributions by
assuming the distributions have <strong>fixed</strong> parameters or
whether they have <strong>variable</strong> parameters. To understand
the difference between <strong>fixed</strong> and
<strong>variable</strong> distributions, let’s consider the incubation
period.</p>
<div id="delays-and-data" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="delays-and-data" class="callout-inner">
<h3 class="callout-title">Delays and data<a class="anchor" aria-label="anchor" href="#delays-and-data"></a>
</h3>
<div class="callout-content">
<p>The number of delays and type of delay is a flexible input that
depends on the data. The examples below highlight how the delays can be
specified for different data sources:</p>
<center>
<table class="table">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th>Data source</th>
<th>Delay(s)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Time of case report</td>
<td>Incubation period + time from symptom onset to case
notification</td>
</tr>
<tr class="even">
<td>Time of hospitalisation</td>
<td>Incubation period + time from symptom onset to hospitalisation</td>
</tr>
<tr class="odd">
<td>Time of symptom onset</td>
<td>Incubation period</td>
</tr>
</tbody>
</table>
</center>
</div>
</div>
</div>
<div class="section level4">
<h4 id="incubation-period-distribution">Incubation period distribution<a class="anchor" aria-label="anchor" href="#incubation-period-distribution"></a>
</h4>
<p>The distribution of incubation period can usually be obtained from
the literature. The package <code>{epiparameter}</code> contains a
library of epidemiological parameters for different diseases obtained
from the literature.</p>
<p>We specify a (fixed) gamma distribution with mean <span class="math inline">\(\mu = 4\)</span> and standard deviation <span class="math inline">\(\sigma^2= 2\)</span> (shape = <span class="math inline">\(4\)</span>, scale = <span class="math inline">\(1\)</span>) using the function
<code>dist_spec()</code> as follows:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">incubation_period_fixed</span> <span class="op">&lt;-</span> <span class="fu">dist_spec</span><span class="op">(</span></span>
<span>  mean <span class="op">=</span> <span class="fl">4</span>, sd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  max <span class="op">=</span> <span class="fl">20</span>, distribution <span class="op">=</span> <span class="st">"gamma"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">incubation_period_fixed</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
  Fixed distribution with PMF [0.019 0.12 0.21 0.21 0.17 0.11 0.069 0.039 0.021 0.011 0.0054 0.0026 0.0012 0.00058 0.00026 0.00012 5.3e-05 2.3e-05 1e-05 4.3e-06]</code></pre>
</div>
<p>The argument <code>max</code> is the maximum value the distribution
can take, in this example 20 days.</p>
<div id="why-a-gamma-distrubution" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="why-a-gamma-distrubution" class="callout-inner">
<h3 class="callout-title">Why a gamma distrubution?<a class="anchor" aria-label="anchor" href="#why-a-gamma-distrubution"></a>
</h3>
<div class="callout-content">
<p>The incubation period has to be positive in value. Therefore we must
specific a distribution in <code>dist_spec</code> which is for positive
values only.</p>
<p><code>dist_spec()</code> supports log normal and gamma distributions,
which are distributions for positive values only.</p>
<p>For all types of delay, we will need to use distributions for
positive values only - we don’t want to include delays of negative days
in our analysis!</p>
</div>
</div>
</div>
</div>
<div class="section level4">
<h4 id="including-distribution-uncertainty">Including distribution uncertainty<a class="anchor" aria-label="anchor" href="#including-distribution-uncertainty"></a>
</h4>
<p>To specify a <strong>variable</strong> distribution, we include
uncertainty around the mean <span class="math inline">\(\mu\)</span> and
standard deviation <span class="math inline">\(\sigma^2\)</span> of our
gamma distribution. If our incubation period distribution has a mean
<span class="math inline">\(\mu\)</span> and standard deviation <span class="math inline">\(\sigma^2\)</span>, then we assume the mean (<span class="math inline">\(\mu\)</span>) follows a Normal distribution with
standard deviation <span class="math inline">\(\sigma_{\mu}^2\)</span>:</p>
<p><span class="math display">\[\mbox{Normal}(\mu,\sigma_{\mu}^2)\]</span></p>
<p>and a standard deviation (<span class="math inline">\(\sigma^2\)</span>) follows a Normal distribution
with standard deviation <span class="math inline">\(\sigma_{\sigma^2}^2\)</span>:</p>
<p><span class="math display">\[\mbox{Normal}(\sigma^2,\sigma_{\sigma^2}^2).\]</span></p>
<p>We specify this using <code>dist_spec</code> with the additional
arguments <code>mean_sd</code> (<span class="math inline">\(\sigma_{\mu}^2\)</span>) and <code>sd_sd</code>
(<span class="math inline">\(\sigma_{\sigma^2}^2\)</span>).</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">incubation_period_variable</span> <span class="op">&lt;-</span> <span class="fu">dist_spec</span><span class="op">(</span></span>
<span>  mean <span class="op">=</span> <span class="fl">4</span>, sd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  mean_sd <span class="op">=</span> <span class="fl">0.5</span>, sd_sd <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  max <span class="op">=</span> <span class="fl">20</span>, distribution <span class="op">=</span> <span class="st">"gamma"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">incubation_period_variable</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
  Uncertain gamma distribution with (untruncated) mean 4 (SD 0.5) and SD 2 (SD 0.5)</code></pre>
</div>
</div>
<div class="section level4">
<h4 id="reporting-delays">Reporting delays<a class="anchor" aria-label="anchor" href="#reporting-delays"></a>
</h4>
<p>After the incubation period, there will be an additional delay of
time from symptom onset to case notification: the reporting delay. We
can specify this as a fixed or variable distribution, or estimate a
distribution from data.</p>
<p>When specifying a distribution, it is useful to visualise the
probability density to see the peak and spread of the distribution, in
this case we will use a log normal distribution. We can use the
functions <code>convert_to_logmean()</code> and
<code>convert_to_logsd()</code> to convert the mean and standard
deviation of a normal distribution to that of a log normal
distribution.</p>
<p>If we want to assume that the mean reporting delay is 2 days (with a
standard deviation of 1 day), the log normal distribution will look
like:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">log_mean</span> <span class="op">&lt;-</span> <span class="fu">convert_to_logmean</span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">log_sd</span> <span class="op">&lt;-</span> <span class="fu">convert_to_logsd</span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">seq</span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">10</span>, length <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, density <span class="op">=</span> <span class="fu">dlnorm</span><span class="op">(</span><span class="va">x</span>, meanlog <span class="op">=</span> <span class="va">log_mean</span>, sdlog <span class="op">=</span> <span class="va">log_sd</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span></span>
<span>    <span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">density</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_grey</span><span class="op">(</span></span>
<span>    base_size <span class="op">=</span> <span class="fl">15</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/quantify-transmissibility-rendered-unnamed-chunk-7-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Using the mean and standard deviation for the log normal
distribution, we can specify a fixed or variable distribution using
<code>dist_spec()</code> as before:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reporting_delay_variable</span> <span class="op">&lt;-</span> <span class="fu">dist_spec</span><span class="op">(</span></span>
<span>  mean <span class="op">=</span> <span class="va">log_mean</span>, sd <span class="op">=</span> <span class="va">log_sd</span>,</span>
<span>  mean_sd <span class="op">=</span> <span class="fl">0.5</span>, sd_sd <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  max <span class="op">=</span> <span class="fl">10</span>, distribution <span class="op">=</span> <span class="st">"lognormal"</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<p>If data is available on the time between symptom onset and reporting,
we can use the function <code>estimate_delay()</code> to estimate a log
normal distribution from a vector of delays. The code below illustrates
how to use <code>estimate_delay()</code> with synthetic delay data.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">delay_data</span> <span class="op">&lt;-</span> <span class="fu">rlnorm</span><span class="op">(</span><span class="fl">500</span>, <span class="fu">log</span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span> <span class="co"># synthetic delay data</span></span>
<span><span class="va">reporting_delay</span> <span class="op">&lt;-</span> <span class="fu">estimate_delay</span><span class="op">(</span></span>
<span>  <span class="va">delay_data</span>,</span>
<span>  samples <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  bootstraps <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="generation-time">Generation time<a class="anchor" aria-label="anchor" href="#generation-time"></a>
</h4>
<p>We also must specify a distribution for the generation time. Here we
will use a log normal distribution with mean 3.6 and standard deviation
3.1 (<a href="https://doi.org/10.2807/1560-7917.ES.2020.25.17.2000257" class="external-link">Ganyani
et al. 2020</a>).</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">generation_time_variable</span> <span class="op">&lt;-</span> <span class="fu">dist_spec</span><span class="op">(</span></span>
<span>  mean <span class="op">=</span> <span class="fl">3.6</span>, sd <span class="op">=</span> <span class="fl">3.1</span>,</span>
<span>  mean_sd <span class="op">=</span> <span class="fl">0.5</span>, sd_sd <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  max <span class="op">=</span> <span class="fl">20</span>, distribution <span class="op">=</span> <span class="st">"lognormal"</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</section><section id="finding-estimates"><h2 class="section-heading">Finding estimates<a class="anchor" aria-label="anchor" href="#finding-estimates"></a>
</h2>
<hr class="half-width">
<p>The function <code>epinow()</code> is a wrapper for the function
<code>estimate_infections()</code> used to estimate cases by date of
infection. The generation time distribution and delay distributions must
be passed using the functions <code>generation_time_opts()</code> and
<code>delay_opts()</code> respectively.</p>
<p>There are numerous other inputs that can be passed to
<code>epinow()</code>, see <code>EpiNow2::?epinow()</code> for more
detail. One optional input is to specify a log normal prior for the
effective reproduction number <span class="math inline">\(R_t\)</span>
at the start of the outbreak. We specify a mean and standard deviation
as arguments of <code>prior</code> within <code>rt_opts()</code>:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rt_log_mean</span> <span class="op">&lt;-</span> <span class="fu">convert_to_logmean</span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">rt_log_sd</span> <span class="op">&lt;-</span> <span class="fu">convert_to_logsd</span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">rt</span> <span class="op">&lt;-</span> <span class="fu">rt_opts</span><span class="op">(</span>prior <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>mean <span class="op">=</span> <span class="va">rt_log_mean</span>, sd <span class="op">=</span> <span class="va">rt_log_sd</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div id="bayesian-inference-using-stan" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="bayesian-inference-using-stan" class="callout-inner">
<h3 class="callout-title">Bayesian inference using Stan<a class="anchor" aria-label="anchor" href="#bayesian-inference-using-stan"></a>
</h3>
<div class="callout-content">
<p>The Bayesian inference is performed using MCMC methods with the
program <a href="https://mc-stan.org/" class="external-link">Stan</a>. There are a number of
default inputs to the Stan functions including the number of chains and
number of samples per chain (see
<code>?EpiNow2::stan_opts()</code>).</p>
<p>To reduce computation time, we can run chains in parallel. To do
this, we must set the number of cores to be used. By default, 4 MCMC
chains are run (see <code>stan_opts()$chains</code>), so we can set an
equal number of cores to be used in parallel as follows:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">withr</span><span class="fu">::</span><span class="fu">local_options</span><span class="op">(</span><span class="fu">list</span><span class="op">(</span>mc.cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>To find the maximum number of available cores on your machine, use
<code>parallel::detectCores()</code>.</p>
</div>
</div>
</div>
<p><em>Note : in the code below fixed distributions are used instead of
variable. This is to speed up computation time. It is generally
recommended to use variable distributions that account for additional
uncertainty.</em></p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reported_cases</span> <span class="op">&lt;-</span> <span class="va">cases</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">90</span>, <span class="op">]</span></span>
<span><span class="va">estimates</span> <span class="op">&lt;-</span> <span class="fu">epinow</span><span class="op">(</span></span>
<span>  reported_cases <span class="op">=</span> <span class="va">reported_cases</span>,</span>
<span>  generation_time <span class="op">=</span> <span class="fu">generation_time_opts</span><span class="op">(</span><span class="va">generation_time_fixed</span><span class="op">)</span>,</span>
<span>  delays <span class="op">=</span> <span class="fu">delay_opts</span><span class="op">(</span><span class="va">incubation_period_fixed</span> <span class="op">+</span> <span class="va">reporting_delay_fixed</span><span class="op">)</span>,</span>
<span>  rt <span class="op">=</span> <span class="fu">rt_opts</span><span class="op">(</span>prior <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>mean <span class="op">=</span> <span class="va">rt_log_mean</span>, sd <span class="op">=</span> <span class="va">rt_log_sd</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>WARN [2024-02-08 10:24:53] epinow: There were 12 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them. - 
WARN [2024-02-08 10:24:53] epinow: Examine the pairs() plot to diagnose sampling problems
 - </code></pre>
</div>
<div class="section level3">
<h3 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h3>
<p>We can extract and visualise estimates of the effective reproduction
number through time:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">estimates</span><span class="op">$</span><span class="va">plots</span><span class="op">$</span><span class="va">R</span></span></code></pre>
</div>
<figure><img src="fig/quantify-transmissibility-rendered-unnamed-chunk-15-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The uncertainty in the estimates increases through time. This is
because estimates are informed by data in the past - within the delay
periods. This difference in uncertainty is categorised into
<strong>Estimate</strong> (green) utilises all data and <strong>Estimate
based on partial data</strong> (orange) estimates that are based on less
data (because infections that happened at the time are more likely to
not have been observed yet) and therefore have increasingly wider
intervals towards the date of the last data point. Finally, the
<strong>Forecast</strong> (purple) is a projection ahead of time.</p>
<p>We can also visualise the growth rate estimate through time:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">estimates</span><span class="op">$</span><span class="va">plots</span><span class="op">$</span><span class="va">growth_rate</span></span></code></pre>
</div>
<figure><img src="fig/quantify-transmissibility-rendered-unnamed-chunk-16-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>To extract a summary of the key transmission metrics at the
<em>latest date</em> in the data:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">estimates</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>                                 measure                 estimate
                                  &lt;char&gt;                   &lt;char&gt;
1: New confirmed cases by infection date     7232 (4056 -- 12590)
2:        Expected change in daily cases        Likely decreasing
3:            Effective reproduction no.       0.89 (0.57 -- 1.3)
4:                        Rate of growth -0.015 (-0.064 -- 0.039)
5:          Doubling/halving time (days)          -47 (18 -- -11)</code></pre>
</div>
<p>As these estimates are based on partial data, they have a wide
uncertainty interval.</p>
<ul>
<li><p>From the summary of our analysis we see that the expected change
in daily cases is Likely decreasing with the estimated new confirmed
cases 7232 (4056 – 12590).</p></li>
<li><p>The effective reproduction number <span class="math inline">\(R_t\)</span> estimate (on the last date of the
data) is 0.89 (0.57 – 1.3).</p></li>
<li><p>The exponential growth rate of case numbers is -0.015 (-0.064 –
0.039).</p></li>
<li><p>The doubling time (the time taken for case numbers to double) is
-47 (18 – -11).</p></li>
</ul>
<div id="expected-change-in-daily-cases" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="expected-change-in-daily-cases" class="callout-inner">
<h3 class="callout-title">
<code>Expected change in daily cases</code><a class="anchor" aria-label="anchor" href="#expected-change-in-daily-cases"></a>
</h3>
<div class="callout-content">
<p>A factor describing expected change in daily cases based on the
posterior probability that <span class="math inline">\(R_t &lt;
1\)</span>.</p>
<center>
<table class="table">
<thead><tr class="header">
<th>Probability (<span class="math inline">\(p\)</span>)</th>
<th>Expected change</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(p &lt; 0.05\)</span></td>
<td>Increasing</td>
</tr>
<tr class="even">
<td><span class="math inline">\(0.05 \leq p&lt; 0.4\)</span></td>
<td>Likely increasing</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(0.4 \leq p&lt; 0.6\)</span></td>
<td>Stable</td>
</tr>
<tr class="even">
<td><span class="math inline">\(0.6 \leq p &lt; 0.95\)</span></td>
<td>Likely decreasing</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(0.95 \leq p \leq 1\)</span></td>
<td>Decreasing</td>
</tr>
</tbody>
</table>
</center>
</div>
</div>
</div>
</div>
</section><section id="quantify-geographical-heterogeneity"><h2 class="section-heading">Quantify geographical heterogeneity<a class="anchor" aria-label="anchor" href="#quantify-geographical-heterogeneity"></a>
</h2>
<hr class="half-width">
<p>The outbreak data of the start of the COVID-19 pandemic from the
United Kingdom from the R package <a href="https://www.reconverse.org/incidence2/" class="external-link">incidence2</a> includes the
region in which the cases were recorded. To find regional estimates of
the effective reproduction number and cases, we must format the data to
have three columns:</p>
<ul>
<li>
<code>date</code> : the date,</li>
<li>
<code>region</code> : the region,</li>
<li>
<code>confirm</code> : number of confirmed cases for a region on a
given date.</li>
</ul>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regional_cases</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">incidence2</span><span class="fu">::</span><span class="va">covidregionaldataUK</span><span class="op">[</span>, <span class="fu">c</span><span class="op">(</span><span class="st">"date"</span>, <span class="st">"cases_new"</span>, <span class="st">"region"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu">colnames</span><span class="op">(</span><span class="va">regional_cases</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"date"</span>, <span class="st">"confirm"</span>, <span class="st">"region"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># extract the first 90 dates for all regions</span></span>
<span><span class="va">dates</span> <span class="op">&lt;-</span> <span class="fu">sort</span><span class="op">(</span><span class="fu">unique</span><span class="op">(</span><span class="va">regional_cases</span><span class="op">$</span><span class="va">date</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">90</span><span class="op">]</span></span>
<span><span class="va">regional_cases</span> <span class="op">&lt;-</span> <span class="va">regional_cases</span><span class="op">[</span><span class="fu">which</span><span class="op">(</span><span class="va">regional_cases</span><span class="op">$</span><span class="va">date</span> <span class="op">%in%</span> <span class="va">dates</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">regional_cases</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>        date confirm          region
1 2020-01-30      NA   East Midlands
2 2020-01-30      NA East of England
3 2020-01-30       2         England
4 2020-01-30      NA          London
5 2020-01-30      NA      North East
6 2020-01-30      NA      North West</code></pre>
</div>
<p>To find regional estimates, we use the same inputs as
<code>epinow()</code> to the function
<code>regional_epinow()</code>:</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">estimates_regional</span> <span class="op">&lt;-</span> <span class="fu">regional_epinow</span><span class="op">(</span></span>
<span>  reported_cases <span class="op">=</span> <span class="va">regional_cases</span>,</span>
<span>  generation_time <span class="op">=</span> <span class="fu">generation_time_opts</span><span class="op">(</span><span class="va">generation_time_fixed</span><span class="op">)</span>,</span>
<span>  delays <span class="op">=</span> <span class="fu">delay_opts</span><span class="op">(</span><span class="va">incubation_period_fixed</span> <span class="op">+</span> <span class="va">reporting_delay_fixed</span><span class="op">)</span>,</span>
<span>  rt <span class="op">=</span> <span class="fu">rt_opts</span><span class="op">(</span>prior <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>mean <span class="op">=</span> <span class="va">rt_log_mean</span>, sd <span class="op">=</span> <span class="va">rt_log_sd</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>INFO [2024-02-08 10:24:58] Producing following optional outputs: regions, summary, samples, plots, latest
INFO [2024-02-08 10:24:58] Reporting estimates using data up to: 2020-04-28
INFO [2024-02-08 10:24:58] No target directory specified so returning output
INFO [2024-02-08 10:24:58] Producing estimates for: East Midlands, East of England, England, London, North East, North West, Northern Ireland, Scotland, South East, South West, Wales, West Midlands, Yorkshire and The Humber
INFO [2024-02-08 10:24:58] Regions excluded: none
INFO [2024-02-08 11:08:54] Completed regional estimates
INFO [2024-02-08 11:08:54] Regions with estimates: 13
INFO [2024-02-08 11:08:54] Regions with runtime errors: 0
INFO [2024-02-08 11:08:54] Producing summary
INFO [2024-02-08 11:08:54] No summary directory specified so returning summary output
INFO [2024-02-08 11:08:54] No target directory specified so returning timings</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">estimates_regional</span><span class="op">$</span><span class="va">summary</span><span class="op">$</span><span class="va">summarised_results</span><span class="op">$</span><span class="va">table</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>                      Region New confirmed cases by infection date
                      &lt;char&gt;                                &lt;char&gt;
 1:            East Midlands                      340 (211 -- 551)
 2:          East of England                      533 (332 -- 847)
 3:                  England                   3548 (2264 -- 5694)
 4:                   London                      292 (193 -- 460)
 5:               North East                      251 (141 -- 430)
 6:               North West                      566 (327 -- 870)
 7:         Northern Ireland                         45 (23 -- 86)
 8:                 Scotland                      289 (160 -- 522)
 9:               South East                      599 (360 -- 996)
10:               South West                      423 (294 -- 623)
11:                    Wales                        95 (64 -- 136)
12:            West Midlands                      270 (141 -- 488)
13: Yorkshire and The Humber                      478 (284 -- 790)
    Expected change in daily cases Effective reproduction no.
                            &lt;fctr&gt;                     &lt;char&gt;
 1:              Likely increasing          1.2 (0.85 -- 1.6)
 2:              Likely increasing          1.2 (0.84 -- 1.6)
 3:              Likely decreasing         0.91 (0.65 -- 1.3)
 4:              Likely decreasing         0.78 (0.56 -- 1.1)
 5:              Likely decreasing         0.91 (0.59 -- 1.3)
 6:              Likely decreasing         0.87 (0.57 -- 1.2)
 7:              Likely decreasing         0.65 (0.39 -- 1.1)
 8:              Likely decreasing          0.92 (0.6 -- 1.4)
 9:                         Stable         0.99 (0.68 -- 1.4)
10:                     Increasing           1.4 (1.1 -- 1.8)
11:                     Decreasing        0.57 (0.41 -- 0.75)
12:              Likely decreasing          0.7 (0.42 -- 1.1)
13:                         Stable            1 (0.69 -- 1.4)
               Rate of growth Doubling/halving time (days)
                       &lt;char&gt;                       &lt;char&gt;
 1:    0.022 (-0.02 -- 0.069)               31 (10 -- -34)
 2:   0.022 (-0.022 -- 0.066)               32 (11 -- -31)
 3:  -0.011 (-0.051 -- 0.033)              -61 (21 -- -14)
 4:   -0.03 (-0.066 -- 0.011)              -23 (61 -- -11)
 5:   -0.012 (-0.06 -- 0.038)              -58 (18 -- -11)
 6:  -0.017 (-0.063 -- 0.024)              -40 (29 -- -11)
 7:  -0.05 (-0.098 -- 0.0087)               -14 (80 -- -7)
 8:  -0.011 (-0.059 -- 0.043)              -62 (16 -- -12)
 9: -0.00073 (-0.046 -- 0.05)             -940 (14 -- -15)
10:    0.048 (0.012 -- 0.087)                 14 (8 -- 57)
11: -0.064 (-0.094 -- -0.034)            -11 (-20 -- -7.3)
12:  -0.042 (-0.092 -- 0.012)             -17 (57 -- -7.5)
13:  0.0026 (-0.044 -- 0.052)              260 (13 -- -16)</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">estimates_regional</span><span class="op">$</span><span class="va">summary</span><span class="op">$</span><span class="va">plots</span><span class="op">$</span><span class="va">R</span></span></code></pre>
</div>
<figure><img src="fig/quantify-transmissibility-rendered-unnamed-chunk-19-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></section><section id="summary"><h2 class="section-heading">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<hr class="half-width">
<p><code>EpiNow2</code> can be used to estimate transmission metrics
from case data at the start of an outbreak. The reliability of these
estimates depends on the quality of the data and appropriate choice of
delay distributions. In the next tutorial we will learn how to make
forecasts and investigate some of the additional inference options
available in <code>EpiNow2</code>.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Transmission metrics can be estimated from case data after
accounting for delays</li>
<li>Uncertainty can be accounted for in delay distributions</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-create-forecast"><p>Content from <a href="create-forecast.html">Create a short-term forecast</a></p>
<hr>
<p>Last updated on 2024-02-08 |
        
        <a href="https://github.com/epiverse-trace/tutorials/edit/main/episodes/create-forecast.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I create short-term forecasts from case data?</li>
<li>How do I account for incomplete reporting in forecasts?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Learn how to make forecasts of cases using R package
<code>EpiNow2</code>
</li>
<li>Learn how to include an observation process in estimation</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="prerequisites" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div id="prerequisites" class="callout-inner">
<h3 class="callout-title">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h3>
<div class="callout-content">
<ul>
<li>Complete tutorial <a href="quantify-transmissibility.html">Quantifying transmission</a>
</li>
</ul>
<p>Learners should familiarise themselves with following concept
dependencies before working through this tutorial:</p>
<p><strong>Statistics</strong> : probability distributions, principle of
Bayesian analysis.</p>
<p><strong>Epidemic theory</strong> : Effective reproduction number.</p>
</div>
</div>
</div>
<section id="introduction"><h2 class="section-heading">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>Given case data, we can create estimates of the current and future
number of cases by accounting for both delays in reporting and under
reporting. To make statements about the future, we need to make an
assumption of how observations up to today are related to what we expect
to happen in the future. The simplest way of doing so is to assume “no
change”, i.e. the reproduction number remains the same in the future as
last observed. In this tutorial we will create short-term forecasts by
assuming the reproduction number will remain the same as it was
estimated to be on the final date for which data was available.</p>
</section><section id="create-a-short-term-forecast"><h2 class="section-heading">Create a short-term forecast<a class="anchor" aria-label="anchor" href="#create-a-short-term-forecast"></a>
</h2>
<hr class="half-width">
<p>The function <code>epinow()</code> described in the previous tutorial
is a wrapper for the function <code>estimate_infections()</code> used to
estimate cases by date of infection. Using the same code in the previous
tutorial we can extract the short-term forecast using:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reported_cases</span> <span class="op">&lt;-</span> <span class="va">cases</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">90</span>, <span class="op">]</span></span>
<span><span class="va">estimates</span> <span class="op">&lt;-</span> <span class="fu">epinow</span><span class="op">(</span></span>
<span>  reported_cases <span class="op">=</span> <span class="va">reported_cases</span>,</span>
<span>  generation_time <span class="op">=</span> <span class="fu">generation_time_opts</span><span class="op">(</span><span class="va">generation_time_fixed</span><span class="op">)</span>,</span>
<span>  delays <span class="op">=</span> <span class="fu">delay_opts</span><span class="op">(</span><span class="va">incubation_period_fixed</span> <span class="op">+</span> <span class="va">reporting_delay_fixed</span><span class="op">)</span>,</span>
<span>  rt <span class="op">=</span> <span class="fu">rt_opts</span><span class="op">(</span>prior <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>mean <span class="op">=</span> <span class="va">rt_log_mean</span>, sd <span class="op">=</span> <span class="va">rt_log_sd</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>WARN [2024-02-08 11:15:14] epinow: There were 5 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them. - 
WARN [2024-02-08 11:15:14] epinow: Examine the pairs() plot to diagnose sampling problems
 - </code></pre>
</div>
<p>We can visualise the estimates of the effective reproduction number
and the estimated number of cases using <code>plot()</code>. The
estimates are split into three categories:</p>
<ul>
<li><p><strong>Estimate</strong> (green): utilises all data,</p></li>
<li><p><strong>Estimate based on partial data</strong> (orange):
estimates that are based less data are therefore more
uncertain,</p></li>
<li><p><strong>Forecast</strong> (purple): forecasts into the
future.</p></li>
</ul>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">estimates</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/create-forecast-rendered-unnamed-chunk-3-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="forecasting-with-estimates-of-r_t" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="forecasting-with-estimates-of-r_t" class="callout-inner">
<h3 class="callout-title">Forecasting with estimates of<span class="math inline">\(R_t\)</span><a class="anchor" aria-label="anchor" href="#forecasting-with-estimates-of-r_t"></a>
</h3>
<div class="callout-content">
<p>By default, the short-term forecasts are created using the latest
estimate of the reproduction number <span class="math inline">\(R_t\)</span>. As this estimate is based on partial
data, it has considerable uncertainty.</p>
<p>The reproduction number that is projected into the future can be
changed to a less recent estimate based on more data using
<code>rt_opts()</code>:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rt_opts</span><span class="op">(</span>future <span class="op">=</span> <span class="st">"estimate"</span><span class="op">)</span></span></code></pre>
</div>
<p>The result will be less uncertain forecasts (as they are based on
<span class="math inline">\(R_t\)</span> with a narrower uncertainty
interval) but the forecasts will be based on less recent estimates of
<span class="math inline">\(R_t\)</span> and assume no change since
then.</p>
<p>Additionally, there is the option to project the value of <span class="math inline">\(R_t\)</span> into the future using a generic model
by setting <code>future = "project"</code>. As this option uses a model
to forecast the value of <span class="math inline">\(R_t\)</span>, the
result will be forecasts that are more uncertain than
<code>estimate</code>, for an example <a href="https://epiforecasts.io/EpiNow2/dev/articles/estimate_infections_options.html#projecting-the-reproduction-number-with-the-gaussian-process" class="external-link">see
here</a>.</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="incomplete-observations">Incomplete observations<a class="anchor" aria-label="anchor" href="#incomplete-observations"></a>
</h3>
<p>In the previous tutorial we accounted for delays in reporting. In
<code>EpiNow2</code> we also can account for incomplete observations as
in reality, 100% of cases are not reported.</p>
<p>We will pass another input into <code>epinow()</code> called
<code>obs</code> to define an observation model. The format of
<code>obs</code> must be the <code>obs_opt()</code> function (see
<code>?EpiNow2::obs_opts</code> for more detail).</p>
<p>Let’s say we believe the COVID-19 outbreak data from the previous
tutorial do not include all reported cases. We believe that we only
observe 40% of cases. To specify this in the observation model, we must
pass a scaling factor with a mean and standard deviation. If we assume
that 40% of cases are in the case data (with standard deviation 1%),
then we specify the <code>scale</code> input to <code>obs_opts()</code>
as follows:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obs_scale</span> <span class="op">&lt;-</span> <span class="fu">list</span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0.4</span>, sd <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span></code></pre>
</div>
<p>To run the inference framework with this observation process, we add
<code>obs = obs_opts(scale = obs_scale)</code> to the input arguments of
<code>epinow()</code>:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obs_scale</span> <span class="op">&lt;-</span> <span class="fu">list</span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0.4</span>, sd <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="va">reported_cases</span> <span class="op">&lt;-</span> <span class="va">cases</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">90</span>, <span class="op">]</span></span>
<span><span class="va">estimates</span> <span class="op">&lt;-</span> <span class="fu">epinow</span><span class="op">(</span></span>
<span>  reported_cases <span class="op">=</span> <span class="va">reported_cases</span>,</span>
<span>  generation_time <span class="op">=</span> <span class="fu">generation_time_opts</span><span class="op">(</span><span class="va">generation_time_fixed</span><span class="op">)</span>,</span>
<span>  delays <span class="op">=</span> <span class="fu">delay_opts</span><span class="op">(</span><span class="va">incubation_period_fixed</span> <span class="op">+</span> <span class="va">reporting_delay_fixed</span><span class="op">)</span>,</span>
<span>  rt <span class="op">=</span> <span class="fu">rt_opts</span><span class="op">(</span>prior <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>mean <span class="op">=</span> <span class="va">rt_log_mean</span>, sd <span class="op">=</span> <span class="va">rt_log_sd</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  obs <span class="op">=</span> <span class="fu">obs_opts</span><span class="op">(</span>scale <span class="op">=</span> <span class="va">obs_scale</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>WARN [2024-02-08 11:22:06] epinow: There were 4 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them. - 
WARN [2024-02-08 11:22:06] epinow: Examine the pairs() plot to diagnose sampling problems
 - </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">estimates</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>                                 measure                 estimate
                                  &lt;char&gt;                   &lt;char&gt;
1: New confirmed cases by infection date   18000 (10430 -- 33164)
2:        Expected change in daily cases        Likely decreasing
3:            Effective reproduction no.       0.89 (0.59 -- 1.4)
4:                        Rate of growth -0.014 (-0.061 -- 0.043)
5:          Doubling/halving time (days)          -48 (16 -- -11)</code></pre>
</div>
<p>The estimates of transmission measures such as the effective
reproduction number and rate of growth are similar (or the same in
value) compared to when we didn’t account for incomplete observations
(see previous tutorial). However the number of new confirmed cases by
infection date has changed substantially in magnitude to reflect the
assumption that only 40% of cases are in the data set.</p>
<p>We can also change the default distribution from Negative Binomial to
Poisson, remove the default week effect and more. See
<code>?EpiNow2::obs_opts</code> for more detail.</p>
</div>
</section><section id="forecast-secondary-observations"><h2 class="section-heading">Forecast secondary observations<a class="anchor" aria-label="anchor" href="#forecast-secondary-observations"></a>
</h2>
<hr class="half-width">
<p><code>EpiNow2</code> also has the ability to estimate and forecast
secondary observations e.g. deaths, hospitalisations from a primary
observation e.g. cases. Here we will illustrate how to forecast the
number of deaths arising from observed cases of COVID-19 in the early
stages of the UK outbreak.</p>
<p>First, we must format our data to have the following columns:</p>
<ul>
<li>
<code>date</code> : the date (as a date object see
<code>?is.Date()</code>),</li>
<li>
<code>primary</code> : number of primary observations on that date,
in this example <strong>cases</strong>,</li>
<li>
<code>secondary</code> : number of secondary observations date, in
this example <strong>deaths</strong>.</li>
</ul>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reported_cases_deaths</span> <span class="op">&lt;-</span> <span class="fu">aggregate</span><span class="op">(</span></span>
<span>  <span class="fu">cbind</span><span class="op">(</span><span class="va">cases_new</span>, <span class="va">deaths_new</span><span class="op">)</span> <span class="op">~</span> <span class="va">date</span>,</span>
<span>  data <span class="op">=</span></span>
<span>    <span class="fu">incidence2</span><span class="fu">::</span><span class="va">covidregionaldataUK</span><span class="op">[</span>, <span class="fu">c</span><span class="op">(</span><span class="st">"date"</span>, <span class="st">"cases_new"</span>, <span class="st">"deaths_new"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  FUN <span class="op">=</span> <span class="va">sum</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">colnames</span><span class="op">(</span><span class="va">reported_cases_deaths</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"date"</span>, <span class="st">"primary"</span>, <span class="st">"secondary"</span><span class="op">)</span></span></code></pre>
</div>
<p>Using the first 30 days of data on cases and deaths, we will estimate
the relationship between the primary and secondary observations using
<code>estimate_secondary()</code>, then forecast future deaths using
<code>forecast_secondary()</code>. For detail on the model see the <a href="https://epiforecasts.io/EpiNow2/dev/articles/estimate_secondary.html" class="external-link">model
documentation</a>.</p>
<p>We must specify the type of observation using <code>type</code> in
<code>secondary_opts()</code>, options include:</p>
<ul>
<li>“incidence” : secondary observations arise from previous primary
observations, i.e. deaths arising from recorded cases.</li>
<li>“prevalence” : secondary observations arise from a combination
current primary observations and past secondary observations,
i.e. hospital bed usage arising from current hospital admissions and
past hospital bed usage.</li>
</ul>
<p>In this example we specify
<code>secondary_opts(type = "incidence")</code>. See
<code>?EpiNow2::secondary_opts</code> for more detail).</p>
<p>The final key input is the delay distribution between the primary and
secondary observations. Here this is the delay between case report and
death, we assume this follows a gamma distribution with mean of 14 days
and standard deviation of 5 days. Using <code>dist_spec()</code> we
specify a fixed gamma distribution.</p>
<p>There are further function inputs to
<code>estimate_secondary()</code> which can be specified, including
adding an observation process, see
<code>?EpiNow2::estimate_secondary</code> for detail on the options.</p>
<p>To find the model fit between cases and deaths :</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">estimate_cases_to_deaths</span> <span class="op">&lt;-</span> <span class="fu">estimate_secondary</span><span class="op">(</span></span>
<span>  reports <span class="op">=</span> <span class="va">reported_cases_deaths</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, <span class="op">]</span>,</span>
<span>  secondary <span class="op">=</span> <span class="fu">secondary_opts</span><span class="op">(</span>type <span class="op">=</span> <span class="st">"incidence"</span><span class="op">)</span>,</span>
<span>  delays <span class="op">=</span> <span class="fu">delay_opts</span><span class="op">(</span><span class="fu">dist_spec</span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="fl">14</span>, sd <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    max <span class="op">=</span> <span class="fl">30</span>, distribution <span class="op">=</span> <span class="st">"gamma"</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div id="be-cautious-of-timescale" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="be-cautious-of-timescale" class="callout-inner">
<h3 class="callout-title">Be cautious of timescale<a class="anchor" aria-label="anchor" href="#be-cautious-of-timescale"></a>
</h3>
<div class="callout-content">
<p>In the early stages of an outbreak there can be substantial changes
in testing and reporting. If there are testing changes from one month to
another, then there will be a bias in the model fit. Therefore, you
should be cautious of the time-scale of data used in the model fit and
forecast.</p>
</div>
</div>
</div>
<p>We plot the model fit (shaded ribbons) with the secondary
observations (bar plot) and primary observations (dotted line) as
follows:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">estimate_cases_to_deaths</span>, primary <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/create-forecast-rendered-unnamed-chunk-9-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>To use this model fit to forecast deaths, we pass a data frame
consisting of the primary observation (cases) for dates not used in the
model fit.</p>
<p><em>Note : in this tutorial we are using data where we know the
deaths and cases, so we create a data frame by extracting the cases. But
in practice, this would be a different data set consisting of cases
only.</em></p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cases_to_forecast</span> <span class="op">&lt;-</span> <span class="va">reported_cases_deaths</span><span class="op">[</span><span class="fl">31</span><span class="op">:</span><span class="fl">60</span>, <span class="fu">c</span><span class="op">(</span><span class="st">"date"</span>, <span class="st">"primary"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu">colnames</span><span class="op">(</span><span class="va">cases_to_forecast</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"date"</span>, <span class="st">"value"</span><span class="op">)</span></span></code></pre>
</div>
<p>To forecast, we use the model fit
<code>estimate_cases_to_deaths</code>:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">deaths_forecast</span> <span class="op">&lt;-</span> <span class="fu">forecast_secondary</span><span class="op">(</span></span>
<span>  estimate <span class="op">=</span> <span class="va">estimate_cases_to_deaths</span>,</span>
<span>  primary <span class="op">=</span> <span class="va">cases_to_forecast</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">deaths_forecast</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 30 rows containing missing values (`position_stack()`).</code></pre>
</div>
<figure><img src="fig/create-forecast-rendered-unnamed-chunk-11-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The plot shows the forecast secondary observations (deaths) over the
dates which we have recorded cases for. It is also possible to forecast
deaths using forecast cases, here you would specify <code>primary</code>
as the <code>estimates</code> output from
<code>estimate_infections()</code>.</p>
</section><section id="challenge-ebola-outbreak-analysis"><h2 class="section-heading">Challenge : Ebola outbreak analysis<a class="anchor" aria-label="anchor" href="#challenge-ebola-outbreak-analysis"></a>
</h2>
<hr class="half-width">
<div id="challenge1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#challenge1"></a>
</h3>
<div class="callout-content">
<p>Download the file <a href="data/ebola_cases.csv">ebola_cases.csv</a>
and read it into R. The simulated data consists of the date of symptom
onset and number of confirmed cases of the early stages of the Ebola
outbreak in Sierra Leone in 2014.</p>
<p>Using the first 3 months (120 days) of data:</p>
<ol style="list-style-type: decimal">
<li>Estimate of cases increasing or decreasing on day 120 of the
outbreak (Hint: Find the effective reproduction number and growth rate
on day 120)</li>
<li>Create a two week forecast of number of cases</li>
</ol>
<p>You can use the following parameter values for the delay
distribution(s) and generation time distribution.</p>
<ul>
<li>Incubation period : Log normal<span class="math inline">\((2.487,0.330)\)</span> (<a href="https://doi.org/10.1016/j.phrp.2011.04.001" class="external-link">Eichner et
al. 2011</a> via <code>{epiparameter}</code>)</li>
<li>Generation time : Gamma<span class="math inline">\((15.3,
10.1)\)</span> (<a href="https://www.nejm.org/doi/full/10.1056/NEJMoa1411100" class="external-link">WHO Ebola
Response Team 2014</a>)</li>
</ul>
<p>You may include some uncertainty around the mean and standard
deviation of these distributions.</p>
</div>
</div>
</div>
<div id="accordionHint1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint1" aria-expanded="false" aria-controls="collapseHint1">
  <h4 class="accordion-header" id="headingHint1">HINT : data format</h4>
</button>
<div id="collapseHint1" class="accordion-collapse collapse" data-bs-parent="#accordionHint1" aria-labelledby="headingHint1">
<div class="accordion-body">
<p>Ensure the data is in the correct format :</p>
<ul>
<li>
<code>date</code> : the date (as a date object see
<code>?is.Date()</code>),</li>
<li>
<code>confirm</code> : number of confirmed cases on that date.</li>
</ul>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">SOLUTION</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>To estimate the effective reproduction number and growth rate, we
will use the function <code>epinow()</code>.</p>
<p>As the data consists of date of symptom onset, we only need to
specify a delay distribution for the incubation period and the
generation time.</p>
<p>We specify the distributions with some uncertainty around the mean
and standard deviation of the log normal distribution for the incubation
period and the Gamma distribution for the generation time.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ebola_incubation_period</span> <span class="op">&lt;-</span> <span class="fu">dist_spec</span><span class="op">(</span></span>
<span>  mean <span class="op">=</span> <span class="fl">2.487</span>, sd <span class="op">=</span> <span class="fl">0.330</span>,</span>
<span>  mean_sd <span class="op">=</span> <span class="fl">0.5</span>, sd_sd <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  max <span class="op">=</span> <span class="fl">20</span>, distribution <span class="op">=</span> <span class="st">"lognormal"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ebola_generation_time</span> <span class="op">&lt;-</span> <span class="fu">dist_spec</span><span class="op">(</span></span>
<span>  mean <span class="op">=</span> <span class="fl">15.3</span>, sd <span class="op">=</span> <span class="fl">10.1</span>,</span>
<span>  mean_sd <span class="op">=</span> <span class="fl">0.5</span>, sd_sd <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  max <span class="op">=</span> <span class="fl">30</span>, distribution <span class="op">=</span> <span class="st">"gamma"</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<p>As we want to also create a two week forecast, we specify
<code>horizon = 14</code> to forecast 14 days instead of the default 7
days.</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># read data</span></span>
<span><span class="co"># e.g.: if path to file is data/raw-data/ebola_cases.csv then:</span></span>
<span><span class="va">ebola_cases</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">read.csv</span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"raw-data"</span>, <span class="st">"ebola_cases.csv"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># format date column</span></span>
<span><span class="va">ebola_cases</span><span class="op">$</span><span class="va">date</span> <span class="op">&lt;-</span> <span class="fu">as.Date</span><span class="op">(</span><span class="va">ebola_cases</span><span class="op">$</span><span class="va">date</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ebola_estimates</span> <span class="op">&lt;-</span> <span class="fu">epinow</span><span class="op">(</span></span>
<span>  reported_cases <span class="op">=</span> <span class="va">ebola_cases</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">120</span>, <span class="op">]</span>, <span class="co"># first 3 months of data only</span></span>
<span>  generation_time <span class="op">=</span> <span class="fu">generation_time_opts</span><span class="op">(</span><span class="va">ebola_generation_time</span><span class="op">)</span>,</span>
<span>  delays <span class="op">=</span> <span class="fu">delay_opts</span><span class="op">(</span><span class="va">ebola_incubation_period</span><span class="op">)</span>,</span>
<span>  <span class="co"># horizon needs to be 14 days to create two week forecast (default is 7 days)</span></span>
<span>  horizon <span class="op">=</span> <span class="fl">14</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>WARN [2024-02-08 11:24:26] epinow: There were 14 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them. - 
WARN [2024-02-08 11:24:26] epinow: Examine the pairs() plot to diagnose sampling problems
 - </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">ebola_estimates</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>                                 measure                estimate
                                  &lt;char&gt;                  &lt;char&gt;
1: New confirmed cases by infection date         103 (49 -- 263)
2:        Expected change in daily cases              Increasing
3:            Effective reproduction no.        1.7 (1.1 -- 3.1)
4:                        Rate of growth 0.044 (0.0062 -- 0.095)
5:          Doubling/halving time (days)         16 (7.3 -- 110)</code></pre>
</div>
<p>The effective reproduction number <span class="math inline">\(R_t\)</span> estimate (on the last date of the
data) is 1.7 (1.1 – 3.1). The exponential growth rate of case numbers is
0.044 (0.0062 – 0.095).</p>
<p>Visualize the estimates:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">ebola_estimates</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="summary"><h2 class="section-heading">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<hr class="half-width">
<p><code>EpiNow2</code> can be used to create short term forecasts and
to estimate the relationship between different outcomes. There are a
range of model options that can be implemented for different analysis,
including adding an observational process to account for incomplete
reporting. See the <a href="https://epiforecasts.io/EpiNow2/dev/articles/estimate_infections_options.html" class="external-link">vignette</a>
for more details on different model options in <code>EpiNow2</code> that
aren’t covered in these tutorials.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>We can create short-term forecasts by making assumptions about the
future behaviour of the reproduction number</li>
<li>Incomplete case reporting can be accounted for in estimates</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/epiverse-trace/tutorials/edit/main/README.md" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/epiverse-trace/tutorials/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/epiverse-trace/tutorials/" class="external-link">Source</a></p>
				<p><a href="https://github.com/epiverse-trace/tutorials/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:andree.valle-campos@lshtm.ac.uk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/epiverse-trace/sandpaper/tree/patch-renv-github-bug" class="external-link">sandpaper (0.16.2)</a>, <a href="https://github.com/carpentries/pegboard/tree/1bc5753e917d515c3d888ce6cc013c0a680eacfc" class="external-link">pegboard (0.7.3)</a>, and <a href="https://github.com/epiverse-trace/varnish/tree/epiversetheme" class="external-link">varnish (1.0.1.9000)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://epiverse-trace.github.io/tutorials/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "forecasts, epidemic models, interventions",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://epiverse-trace.github.io/tutorials/aio.html",
  "identifier": "https://epiverse-trace.github.io/tutorials/aio.html",
  "dateCreated": "2024-02-08",
  "dateModified": "2024-02-08",
  "datePublished": "2024-02-08"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code -->
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

